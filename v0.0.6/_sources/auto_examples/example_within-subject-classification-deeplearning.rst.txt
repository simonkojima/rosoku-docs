
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/example_within-subject-classification-deeplearning.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_example_within-subject-classification-deeplearning.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_example_within-subject-classification-deeplearning.py:


Example: Within-subject classification with deep learning
=========================================================

.. GENERATED FROM PYTHON SOURCE LINES 7-20

.. code-block:: Python

    import functools

    from pathlib import Path

    import mne

    import moabb.datasets

    import torch
    import braindecode
    import rosoku









.. GENERATED FROM PYTHON SOURCE LINES 21-90

.. code-block:: Python

    def func_get_model(X, y):
        _, n_chans, n_times = X.shape
        F1 = 4
        D = 2
        F2 = F1 * D

        model = braindecode.models.EEGNet(
            n_chans=n_chans,
            n_outputs=2,
            n_times=n_times,
            F1=F1,
            D=D,
            F2=F2,
            drop_prob=0.5,
        )

        return model


    def func_load_epochs(keywords, mode, dataset, l_freq, h_freq, order_filter, tmin, tmax):
        subject = keywords[0]
        keywords = keywords[1:]

        sessions = dataset.get_data(subjects=[subject])
        raws = sessions[subject]["0"]

        epochs_list = []

        for (name_run, raw) in raws.items():
            if not True in [k in name_run for k in keywords]:
                continue

            raw.filter(
                l_freq=l_freq,
                h_freq=h_freq,
                method="iir",
                iir_params={"ftype": "butter", "order": order_filter, "btype": "bandpass"},
            )

            raw = raw.pick(picks="eeg")

            epochs = mne.Epochs(
                raw=raw,
                tmin=tmin,
                tmax=tmax,
                baseline=None,
            )

            epochs_list.append(epochs)

        return mne.concatenate_epochs(epochs_list)


    def func_proc_epochs(epochs, mode):
        # do nothing in this example
        return epochs


    def convert_epochs_to_ndarray(
            epochs,
            mode,
            label_keys,
    ):
        X = epochs.get_data()
        y = rosoku.utils.get_labels_from_epochs(epochs, label_keys)

        return X, y









.. GENERATED FROM PYTHON SOURCE LINES 91-162

.. code-block:: Python


    subject = 56
    resample = 128

    lr = 1e-3
    weight_decay = 1e-2
    n_epochs = 100
    batch_size = 8
    patience = 75
    enable_euclidean_alignment = False
    enable_normalization = True
    device = "cuda" if torch.cuda.is_available() else "cpu"
    enable_ddp = False
    enable_dp = False

    seed = 42

    dataset = moabb.datasets.Dreyer2023()

    save_base = Path("~").expanduser() / "rosoku-log"
    (save_base / "checkpoint").mkdir(parents=True, exist_ok=True)
    (save_base / "history").mkdir(parents=True, exist_ok=True)
    (save_base / "saliency").mkdir(parents=True, exist_ok=True)
    (save_base / "samples").mkdir(parents=True, exist_ok=True)
    (save_base / "normalization").mkdir(parents=True, exist_ok=True)

    criterion = torch.nn.CrossEntropyLoss()
    scheduler = torch.optim.lr_scheduler.CosineAnnealingLR
    scheduler_params = {"T_max": n_epochs, "eta_min": 1e-6}
    optimizer = torch.optim.AdamW
    optimizer_params = {"lr": lr, "weight_decay": weight_decay}
    early_stopping = rosoku.utils.EarlyStopping(patience=patience)

    label_keys = {"left_hand": 0, "right_hand": 1}

    results = rosoku.deeplearning(
        keywords_train=[subject, "R1", "R2"],
        keywords_valid=[subject, "R3"],
        keywords_test=[[subject, "R4", "R5"]],
        func_load_epochs=functools.partial(func_load_epochs, dataset=dataset, l_freq=8.0, h_freq=30.0, order_filter=4,
                                           tmin=dataset.interval[0] + 0.5, tmax=dataset.interval[1]),
        func_proc_epochs=func_proc_epochs,
        func_convert_epochs_to_ndarray=functools.partial(
            convert_epochs_to_ndarray, label_keys=label_keys
        ),
        batch_size=batch_size,
        n_epochs=n_epochs,
        criterion=criterion,
        optimizer=optimizer,
        optimizer_params=optimizer_params,
        func_get_model=func_get_model,
        scheduler=scheduler,
        scheduler_params=scheduler_params,
        device=device,
        enable_ddp=enable_ddp,
        early_stopping=early_stopping,
        enable_normalization=enable_normalization,
        name_classifier="eegnet4.2",
        history_fname=(save_base / "history" / f"sub-{subject}.parquet"),
        checkpoint_fname=(save_base / "checkpoint" / f"sub-{subject}.pth"),
        samples_fname=(save_base / "samples" / f"sub-{subject}.parquet"),
        normalization_fname=(save_base / "normalization" / f"sub-{subject}.msgpack"),
        saliency_map_fname=(save_base / "saliency" / f"sub-{subject}.msgpack"),
        label_keys=label_keys,
        seed=seed,
    )

    for m in range(results.shape[0]):
        print(results.loc[m])

    results.to_parquet(save_base / "results_deeplearning_within-subject.parquet")




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    0it [00:00, ?it/s]    9it [00:00, 23637.28it/s]
    0it [00:00, ?it/s]    9it [00:00, 23130.35it/s]
    0it [00:00, ?it/s]    9it [00:00, 26360.85it/s]
    epoch 000, train_loss: 0.6855, train_acc: 0.69, valid_loss: 0.6885, valid_acc: 0.55, lr: 9.9975e-04, et: 0.3887, checkpoint saved
    epoch 001, train_loss: 0.6791, train_acc: 0.70, valid_loss: 0.6880, valid_acc: 0.57, lr: 9.9901e-04, et: 0.1145, checkpoint saved
    epoch 002, train_loss: 0.6724, train_acc: 0.69, valid_loss: 0.6870, valid_acc: 0.55, lr: 9.9778e-04, et: 0.1093, checkpoint saved
    epoch 003, train_loss: 0.6637, train_acc: 0.71, valid_loss: 0.6869, valid_acc: 0.57, lr: 9.9606e-04, et: 0.1085, checkpoint saved
    epoch 004, train_loss: 0.6523, train_acc: 0.76, valid_loss: 0.6870, valid_acc: 0.53, lr: 9.9385e-04, et: 0.1077
    epoch 005, train_loss: 0.6400, train_acc: 0.80, valid_loss: 0.6905, valid_acc: 0.50, lr: 9.9115e-04, et: 0.1076
    epoch 006, train_loss: 0.6243, train_acc: 0.84, valid_loss: 0.6962, valid_acc: 0.47, lr: 9.8797e-04, et: 0.1075
    epoch 007, train_loss: 0.6079, train_acc: 0.84, valid_loss: 0.7002, valid_acc: 0.53, lr: 9.8431e-04, et: 0.1054
    epoch 008, train_loss: 0.5897, train_acc: 0.85, valid_loss: 0.6997, valid_acc: 0.53, lr: 9.8017e-04, et: 0.1116
    epoch 009, train_loss: 0.5738, train_acc: 0.86, valid_loss: 0.7031, valid_acc: 0.50, lr: 9.7555e-04, et: 0.1046
    epoch 010, train_loss: 0.5550, train_acc: 0.88, valid_loss: 0.7061, valid_acc: 0.53, lr: 9.7047e-04, et: 0.1059
    epoch 011, train_loss: 0.5345, train_acc: 0.88, valid_loss: 0.7100, valid_acc: 0.53, lr: 9.6492e-04, et: 0.1061
    epoch 012, train_loss: 0.5119, train_acc: 0.90, valid_loss: 0.7193, valid_acc: 0.50, lr: 9.5892e-04, et: 0.1091
    epoch 013, train_loss: 0.4908, train_acc: 0.91, valid_loss: 0.7211, valid_acc: 0.50, lr: 9.5246e-04, et: 0.1063
    epoch 014, train_loss: 0.4731, train_acc: 0.91, valid_loss: 0.7195, valid_acc: 0.53, lr: 9.4556e-04, et: 0.1066
    epoch 015, train_loss: 0.4493, train_acc: 0.93, valid_loss: 0.7165, valid_acc: 0.53, lr: 9.3822e-04, et: 0.1058
    epoch 016, train_loss: 0.4233, train_acc: 0.93, valid_loss: 0.7128, valid_acc: 0.55, lr: 9.3044e-04, et: 0.1056
    epoch 017, train_loss: 0.3935, train_acc: 0.93, valid_loss: 0.7165, valid_acc: 0.57, lr: 9.2224e-04, et: 0.1056
    epoch 018, train_loss: 0.3677, train_acc: 0.95, valid_loss: 0.7194, valid_acc: 0.57, lr: 9.1363e-04, et: 0.1062
    epoch 019, train_loss: 0.3455, train_acc: 0.95, valid_loss: 0.7180, valid_acc: 0.57, lr: 9.0460e-04, et: 0.1060
    epoch 020, train_loss: 0.3168, train_acc: 0.96, valid_loss: 0.6993, valid_acc: 0.60, lr: 8.9518e-04, et: 0.1079
    epoch 021, train_loss: 0.2858, train_acc: 0.96, valid_loss: 0.6730, valid_acc: 0.65, lr: 8.8537e-04, et: 0.1067, checkpoint saved
    epoch 022, train_loss: 0.2641, train_acc: 0.99, valid_loss: 0.6418, valid_acc: 0.68, lr: 8.7518e-04, et: 0.1061, checkpoint saved
    epoch 023, train_loss: 0.2339, train_acc: 1.00, valid_loss: 0.6205, valid_acc: 0.68, lr: 8.6462e-04, et: 0.1073, checkpoint saved
    epoch 024, train_loss: 0.2244, train_acc: 1.00, valid_loss: 0.6233, valid_acc: 0.65, lr: 8.5370e-04, et: 0.1077
    epoch 025, train_loss: 0.2111, train_acc: 1.00, valid_loss: 0.6109, valid_acc: 0.65, lr: 8.4243e-04, et: 0.1061, checkpoint saved
    epoch 026, train_loss: 0.2039, train_acc: 1.00, valid_loss: 0.6134, valid_acc: 0.68, lr: 8.3083e-04, et: 0.1055
    epoch 027, train_loss: 0.1793, train_acc: 1.00, valid_loss: 0.5782, valid_acc: 0.68, lr: 8.1889e-04, et: 0.1055, checkpoint saved
    epoch 028, train_loss: 0.1567, train_acc: 1.00, valid_loss: 0.5519, valid_acc: 0.68, lr: 8.0665e-04, et: 0.1060, checkpoint saved
    epoch 029, train_loss: 0.1496, train_acc: 1.00, valid_loss: 0.5504, valid_acc: 0.68, lr: 7.9410e-04, et: 0.1050, checkpoint saved
    epoch 030, train_loss: 0.1100, train_acc: 1.00, valid_loss: 0.4733, valid_acc: 0.70, lr: 7.8126e-04, et: 0.1054, checkpoint saved
    epoch 031, train_loss: 0.0852, train_acc: 1.00, valid_loss: 0.4028, valid_acc: 0.80, lr: 7.6815e-04, et: 0.1059, checkpoint saved
    epoch 032, train_loss: 0.0758, train_acc: 1.00, valid_loss: 0.3697, valid_acc: 0.82, lr: 7.5477e-04, et: 0.1050, checkpoint saved
    epoch 033, train_loss: 0.0793, train_acc: 1.00, valid_loss: 0.3792, valid_acc: 0.82, lr: 7.4114e-04, et: 0.1054
    epoch 034, train_loss: 0.0817, train_acc: 0.99, valid_loss: 0.3918, valid_acc: 0.78, lr: 7.2727e-04, et: 0.1060
    epoch 035, train_loss: 0.0766, train_acc: 1.00, valid_loss: 0.4031, valid_acc: 0.75, lr: 7.1318e-04, et: 0.1076
    epoch 036, train_loss: 0.0619, train_acc: 0.99, valid_loss: 0.3620, valid_acc: 0.75, lr: 6.9888e-04, et: 0.1073, checkpoint saved
    epoch 037, train_loss: 0.0386, train_acc: 1.00, valid_loss: 0.2831, valid_acc: 0.90, lr: 6.8438e-04, et: 0.1082, checkpoint saved
    epoch 038, train_loss: 0.0322, train_acc: 1.00, valid_loss: 0.2611, valid_acc: 0.90, lr: 6.6970e-04, et: 0.1049, checkpoint saved
    epoch 039, train_loss: 0.0282, train_acc: 1.00, valid_loss: 0.2555, valid_acc: 0.93, lr: 6.5485e-04, et: 0.1064, checkpoint saved
    epoch 040, train_loss: 0.0260, train_acc: 1.00, valid_loss: 0.2591, valid_acc: 0.93, lr: 6.3986e-04, et: 0.1059
    epoch 041, train_loss: 0.0290, train_acc: 1.00, valid_loss: 0.2714, valid_acc: 0.90, lr: 6.2472e-04, et: 0.1058
    epoch 042, train_loss: 0.0259, train_acc: 1.00, valid_loss: 0.2565, valid_acc: 0.93, lr: 6.0946e-04, et: 0.1063
    epoch 043, train_loss: 0.0236, train_acc: 1.00, valid_loss: 0.2350, valid_acc: 0.93, lr: 5.9410e-04, et: 0.1075, checkpoint saved
    epoch 044, train_loss: 0.0217, train_acc: 1.00, valid_loss: 0.2251, valid_acc: 0.93, lr: 5.7864e-04, et: 0.1083, checkpoint saved
    epoch 045, train_loss: 0.0182, train_acc: 1.00, valid_loss: 0.2211, valid_acc: 0.93, lr: 5.6310e-04, et: 0.1067, checkpoint saved
    epoch 046, train_loss: 0.0181, train_acc: 1.00, valid_loss: 0.2171, valid_acc: 0.93, lr: 5.4751e-04, et: 0.1059, checkpoint saved
    epoch 047, train_loss: 0.0150, train_acc: 1.00, valid_loss: 0.2115, valid_acc: 0.93, lr: 5.3186e-04, et: 0.1049, checkpoint saved
    epoch 048, train_loss: 0.0146, train_acc: 1.00, valid_loss: 0.2166, valid_acc: 0.93, lr: 5.1619e-04, et: 0.1075
    epoch 049, train_loss: 0.0174, train_acc: 1.00, valid_loss: 0.2177, valid_acc: 0.93, lr: 5.0050e-04, et: 0.1100
    epoch 050, train_loss: 0.0174, train_acc: 1.00, valid_loss: 0.2464, valid_acc: 0.90, lr: 4.8481e-04, et: 0.1086
    epoch 051, train_loss: 0.0127, train_acc: 1.00, valid_loss: 0.2242, valid_acc: 0.90, lr: 4.6914e-04, et: 0.1065
    epoch 052, train_loss: 0.0090, train_acc: 1.00, valid_loss: 0.2003, valid_acc: 0.90, lr: 4.5349e-04, et: 0.1064, checkpoint saved
    epoch 053, train_loss: 0.0083, train_acc: 1.00, valid_loss: 0.1962, valid_acc: 0.90, lr: 4.3790e-04, et: 0.1064, checkpoint saved
    epoch 054, train_loss: 0.0083, train_acc: 1.00, valid_loss: 0.1898, valid_acc: 0.93, lr: 4.2236e-04, et: 0.1059, checkpoint saved
    epoch 055, train_loss: 0.0091, train_acc: 1.00, valid_loss: 0.1847, valid_acc: 0.93, lr: 4.0690e-04, et: 0.1073, checkpoint saved
    epoch 056, train_loss: 0.0089, train_acc: 1.00, valid_loss: 0.1761, valid_acc: 0.93, lr: 3.9154e-04, et: 0.1049, checkpoint saved
    epoch 057, train_loss: 0.0082, train_acc: 1.00, valid_loss: 0.1721, valid_acc: 0.93, lr: 3.7628e-04, et: 0.1077, checkpoint saved
    epoch 058, train_loss: 0.0081, train_acc: 1.00, valid_loss: 0.1755, valid_acc: 0.90, lr: 3.6114e-04, et: 0.1068
    epoch 059, train_loss: 0.0079, train_acc: 1.00, valid_loss: 0.1820, valid_acc: 0.90, lr: 3.4615e-04, et: 0.1083
    epoch 060, train_loss: 0.0085, train_acc: 1.00, valid_loss: 0.1962, valid_acc: 0.90, lr: 3.3130e-04, et: 0.1049
    epoch 061, train_loss: 0.0078, train_acc: 1.00, valid_loss: 0.2000, valid_acc: 0.88, lr: 3.1662e-04, et: 0.1053
    epoch 062, train_loss: 0.0068, train_acc: 1.00, valid_loss: 0.1872, valid_acc: 0.90, lr: 3.0212e-04, et: 0.1058
    epoch 063, train_loss: 0.0066, train_acc: 1.00, valid_loss: 0.1824, valid_acc: 0.90, lr: 2.8782e-04, et: 0.1055
    epoch 064, train_loss: 0.0065, train_acc: 1.00, valid_loss: 0.1815, valid_acc: 0.93, lr: 2.7373e-04, et: 0.1052
    epoch 065, train_loss: 0.0062, train_acc: 1.00, valid_loss: 0.1761, valid_acc: 0.93, lr: 2.5986e-04, et: 0.1056
    epoch 066, train_loss: 0.0059, train_acc: 1.00, valid_loss: 0.1716, valid_acc: 0.93, lr: 2.4623e-04, et: 0.1065, checkpoint saved
    epoch 067, train_loss: 0.0058, train_acc: 1.00, valid_loss: 0.1663, valid_acc: 0.93, lr: 2.3285e-04, et: 0.1049, checkpoint saved
    epoch 068, train_loss: 0.0056, train_acc: 1.00, valid_loss: 0.1664, valid_acc: 0.93, lr: 2.1974e-04, et: 0.1056
    epoch 069, train_loss: 0.0054, train_acc: 1.00, valid_loss: 0.1691, valid_acc: 0.93, lr: 2.0690e-04, et: 0.1054
    epoch 070, train_loss: 0.0054, train_acc: 1.00, valid_loss: 0.1654, valid_acc: 0.93, lr: 1.9435e-04, et: 0.1074, checkpoint saved
    epoch 071, train_loss: 0.0053, train_acc: 1.00, valid_loss: 0.1600, valid_acc: 0.93, lr: 1.8211e-04, et: 0.1051, checkpoint saved
    epoch 072, train_loss: 0.0051, train_acc: 1.00, valid_loss: 0.1584, valid_acc: 0.93, lr: 1.7017e-04, et: 0.1051, checkpoint saved
    epoch 073, train_loss: 0.0050, train_acc: 1.00, valid_loss: 0.1589, valid_acc: 0.93, lr: 1.5857e-04, et: 0.1047
    epoch 074, train_loss: 0.0050, train_acc: 1.00, valid_loss: 0.1616, valid_acc: 0.90, lr: 1.4730e-04, et: 0.1059
    epoch 075, train_loss: 0.0049, train_acc: 1.00, valid_loss: 0.1612, valid_acc: 0.90, lr: 1.3638e-04, et: 0.1054
    epoch 076, train_loss: 0.0049, train_acc: 1.00, valid_loss: 0.1599, valid_acc: 0.90, lr: 1.2582e-04, et: 0.1076
    epoch 077, train_loss: 0.0049, train_acc: 1.00, valid_loss: 0.1579, valid_acc: 0.93, lr: 1.1563e-04, et: 0.1083, checkpoint saved
    epoch 078, train_loss: 0.0050, train_acc: 1.00, valid_loss: 0.1591, valid_acc: 0.93, lr: 1.0582e-04, et: 0.1076
    epoch 079, train_loss: 0.0049, train_acc: 1.00, valid_loss: 0.1602, valid_acc: 0.93, lr: 9.6396e-05, et: 0.1062
    epoch 080, train_loss: 0.0048, train_acc: 1.00, valid_loss: 0.1614, valid_acc: 0.93, lr: 8.7373e-05, et: 0.1057
    epoch 081, train_loss: 0.0047, train_acc: 1.00, valid_loss: 0.1620, valid_acc: 0.93, lr: 7.8758e-05, et: 0.1053
    epoch 082, train_loss: 0.0046, train_acc: 1.00, valid_loss: 0.1629, valid_acc: 0.93, lr: 7.0559e-05, et: 0.1061
    epoch 083, train_loss: 0.0045, train_acc: 1.00, valid_loss: 0.1642, valid_acc: 0.93, lr: 6.2785e-05, et: 0.1073
    epoch 084, train_loss: 0.0044, train_acc: 1.00, valid_loss: 0.1643, valid_acc: 0.93, lr: 5.5442e-05, et: 0.1051
    epoch 085, train_loss: 0.0044, train_acc: 1.00, valid_loss: 0.1642, valid_acc: 0.93, lr: 4.8539e-05, et: 0.1062
    epoch 086, train_loss: 0.0044, train_acc: 1.00, valid_loss: 0.1640, valid_acc: 0.93, lr: 4.2082e-05, et: 0.1080
    epoch 087, train_loss: 0.0044, train_acc: 1.00, valid_loss: 0.1638, valid_acc: 0.93, lr: 3.6077e-05, et: 0.1080
    epoch 088, train_loss: 0.0044, train_acc: 1.00, valid_loss: 0.1635, valid_acc: 0.93, lr: 3.0530e-05, et: 0.1062
    epoch 089, train_loss: 0.0044, train_acc: 1.00, valid_loss: 0.1639, valid_acc: 0.93, lr: 2.5447e-05, et: 0.1076
    epoch 090, train_loss: 0.0044, train_acc: 1.00, valid_loss: 0.1645, valid_acc: 0.93, lr: 2.0833e-05, et: 0.1066
    epoch 091, train_loss: 0.0044, train_acc: 1.00, valid_loss: 0.1644, valid_acc: 0.93, lr: 1.6693e-05, et: 0.1082
    epoch 092, train_loss: 0.0044, train_acc: 1.00, valid_loss: 0.1639, valid_acc: 0.93, lr: 1.3030e-05, et: 0.1068
    epoch 093, train_loss: 0.0044, train_acc: 1.00, valid_loss: 0.1646, valid_acc: 0.93, lr: 9.8475e-06, et: 0.1075
    epoch 094, train_loss: 0.0043, train_acc: 1.00, valid_loss: 0.1650, valid_acc: 0.93, lr: 7.1497e-06, et: 0.1061
    epoch 095, train_loss: 0.0043, train_acc: 1.00, valid_loss: 0.1650, valid_acc: 0.93, lr: 4.9387e-06, et: 0.1069
    epoch 096, train_loss: 0.0043, train_acc: 1.00, valid_loss: 0.1649, valid_acc: 0.93, lr: 3.2168e-06, et: 0.1071
    epoch 097, train_loss: 0.0043, train_acc: 1.00, valid_loss: 0.1649, valid_acc: 0.93, lr: 1.9856e-06, et: 0.1060
    epoch 098, train_loss: 0.0043, train_acc: 1.00, valid_loss: 0.1646, valid_acc: 0.93, lr: 1.2465e-06, et: 0.1061
    epoch 099, train_loss: 0.0043, train_acc: 1.00, valid_loss: 0.1649, valid_acc: 0.93, lr: 1.0000e-06, et: 0.1055
    Elapsed Time: 11.04s
    keywords_train    [56, "R1", "R2"]
    keywords_valid          [56, "R3"]
    keywords_test     [56, "R4", "R5"]
    classifier               eegnet4.2
    accuracy                     0.975
    Name: 0, dtype: object





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 14.873 seconds)


.. _sphx_glr_download_auto_examples_example_within-subject-classification-deeplearning.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: example_within-subject-classification-deeplearning.ipynb <example_within-subject-classification-deeplearning.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: example_within-subject-classification-deeplearning.py <example_within-subject-classification-deeplearning.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: example_within-subject-classification-deeplearning.zip <example_within-subject-classification-deeplearning.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
