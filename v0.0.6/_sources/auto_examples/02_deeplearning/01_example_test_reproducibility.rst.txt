
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/02_deeplearning/01_example_test_reproducibility.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_02_deeplearning_01_example_test_reproducibility.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_02_deeplearning_01_example_test_reproducibility.py:


Example 01: Testing Reproducibility of Deeplearning Experiments
===============================================================

.. GENERATED FROM PYTHON SOURCE LINES 5-10

.. code-block:: Python


    # Authors: Simon Kojima <simon.kojima@inria.fr>
    #
    # License: BSD (3-clause)








.. GENERATED FROM PYTHON SOURCE LINES 11-13

Import Packages
===============

.. GENERATED FROM PYTHON SOURCE LINES 13-23

.. code-block:: Python

    import functools
    from pathlib import Path
    import mne
    import torch
    import braindecode
    import rosoku

    from moabb.datasets import Dreyer2023









.. GENERATED FROM PYTHON SOURCE LINES 24-26

Define callback functions
=========================

.. GENERATED FROM PYTHON SOURCE LINES 26-97

.. code-block:: Python

    def callback_get_model(X, y):
        _, n_chans, n_times = X.shape
        F1 = 4
        D = 2
        F2 = F1 * D

        model = braindecode.models.EEGNet(
            n_chans=n_chans,
            n_outputs=2,
            n_times=n_times,
            F1=F1,
            D=D,
            F2=F2,
            drop_prob=0.5,
        )

        return model


    def callback_load_epochs(
        items, split, dataset, l_freq, h_freq, order_filter, tmin, tmax
    ):
        subject = items[0]
        items = items[1:]

        sessions = dataset.get_data(subjects=[subject])
        raws_dict = sessions[subject]["0"]

        epochs_list = []

        for name_run, raw in raws_dict.items():
            if not True in [item in name_run for item in items]:
                continue

            raw.filter(
                l_freq=l_freq,
                h_freq=h_freq,
                method="iir",
                iir_params={"ftype": "butter", "order": order_filter, "btype": "bandpass"},
            )

            raw = raw.pick(picks="eeg")

            epochs = mne.Epochs(
                raw=raw,
                tmin=tmin,
                tmax=tmax,
                baseline=None,
            )

            epochs_list.append(epochs)

        return mne.concatenate_epochs(epochs_list)


    def callback_proc_epochs(epochs, split):
        # do nothing in this example
        return epochs


    def convert_epochs_to_ndarray(
        epochs,
        split,
        label_keys,
    ):
        X = epochs.get_data()
        y = rosoku.utils.get_labels_from_epochs(epochs, label_keys)

        return X, y









.. GENERATED FROM PYTHON SOURCE LINES 98-100

Set a Seed
==========

.. GENERATED FROM PYTHON SOURCE LINES 100-103

.. code-block:: Python


    seed = 42








.. GENERATED FROM PYTHON SOURCE LINES 104-106

Run the Experiment
==================

.. GENERATED FROM PYTHON SOURCE LINES 106-177

.. code-block:: Python


    subject = 56
    resample = 128

    lr = 1e-3
    weight_decay = 1e-2
    n_epochs = 100
    batch_size = 8
    patience = 75
    device = "cuda" if torch.cuda.is_available() else "cpu"

    dataset = Dreyer2023()

    save_base = Path("~").expanduser() / "rosoku-log"
    (save_base / "checkpoint").mkdir(parents=True, exist_ok=True)
    (save_base / "history").mkdir(parents=True, exist_ok=True)
    (save_base / "saliency").mkdir(parents=True, exist_ok=True)
    (save_base / "samples").mkdir(parents=True, exist_ok=True)
    (save_base / "normalization").mkdir(parents=True, exist_ok=True)

    criterion = torch.nn.CrossEntropyLoss()
    scheduler = torch.optim.lr_scheduler.CosineAnnealingLR
    scheduler_params = {"T_max": n_epochs, "eta_min": 1e-6}
    optimizer = torch.optim.AdamW
    optimizer_params = {"lr": lr, "weight_decay": weight_decay}
    early_stopping = rosoku.utils.EarlyStopping(patience=patience)

    label_keys = {"left_hand": 0, "right_hand": 1}

    results_list = []

    for _ in range(2):
        results = rosoku.deeplearning(
            items_train=[subject, "R1", "R2"],
            items_valid=[subject, "R3"],
            items_test=[[subject, "R4", "R5"]],
            callback_load_epochs=functools.partial(
                callback_load_epochs,
                dataset=dataset,
                l_freq=8.0,
                h_freq=30.0,
                order_filter=4,
                tmin=dataset.interval[0] + 0.5,
                tmax=dataset.interval[1],
            ),
            callback_proc_epochs=callback_proc_epochs,
            callback_convert_epochs_to_ndarray=functools.partial(
                convert_epochs_to_ndarray, label_keys=label_keys
            ),
            batch_size=batch_size,
            n_epochs=n_epochs,
            criterion=criterion,
            optimizer=optimizer,
            optimizer_params=optimizer_params,
            callback_get_model=callback_get_model,
            scheduler=scheduler,
            scheduler_params=scheduler_params,
            device=device,
            early_stopping=early_stopping,
            history_fname=(save_base / "history" / f"sub-{subject}.parquet"),
            checkpoint_fname=(save_base / "checkpoint" / f"sub-{subject}.pth"),
            samples_fname=(save_base / "samples" / f"sub-{subject}.parquet"),
            normalization_fname=(save_base / "normalization" / f"sub-{subject}.msgpack"),
            saliency_map_fname=(save_base / "saliency" / f"sub-{subject}.msgpack"),
            label_keys=label_keys,
            seed=seed,
            additional_values={"subject": subject},
        )

        results_list.append(results)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    0it [00:00, ?it/s]    9it [00:00, 41711.31it/s]
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    /home/skojima/git/rosoku/examples/02_deeplearning/01_example_test_reproducibility.py:78: RuntimeWarning: Concatenation of Annotations within Epochs is not supported yet. All annotations will be dropped.
      return mne.concatenate_epochs(epochs_list)
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    Not setting metadata
    80 matching events found
    No baseline correction applied
    0it [00:00, ?it/s]    9it [00:00, 43339.54it/s]
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    /home/skojima/git/rosoku/examples/02_deeplearning/01_example_test_reproducibility.py:78: RuntimeWarning: Concatenation of Annotations within Epochs is not supported yet. All annotations will be dropped.
      return mne.concatenate_epochs(epochs_list)
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0it [00:00, ?it/s]    9it [00:00, 42366.71it/s]
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    /home/skojima/git/rosoku/examples/02_deeplearning/01_example_test_reproducibility.py:78: RuntimeWarning: Concatenation of Annotations within Epochs is not supported yet. All annotations will be dropped.
      return mne.concatenate_epochs(epochs_list)
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    Not setting metadata
    80 matching events found
    No baseline correction applied
    epoch 000, train_loss: 0.6805, train_acc: 0.56, valid_loss: 0.6885, valid_acc: 0.55, lr: 9.9975e-04, et: 0.0441, checkpoint saved
    epoch 001, train_loss: 0.6759, train_acc: 0.61, valid_loss: 0.6886, valid_acc: 0.53, lr: 9.9901e-04, et: 0.0426
    epoch 002, train_loss: 0.6314, train_acc: 0.65, valid_loss: 0.6889, valid_acc: 0.53, lr: 9.9778e-04, et: 0.0419
    epoch 003, train_loss: 0.5853, train_acc: 0.76, valid_loss: 0.6895, valid_acc: 0.50, lr: 9.9606e-04, et: 0.0418
    epoch 004, train_loss: 0.6166, train_acc: 0.61, valid_loss: 0.6898, valid_acc: 0.50, lr: 9.9385e-04, et: 0.0419
    epoch 005, train_loss: 0.5462, train_acc: 0.82, valid_loss: 0.6913, valid_acc: 0.47, lr: 9.9115e-04, et: 0.0419
    epoch 006, train_loss: 0.5778, train_acc: 0.79, valid_loss: 0.6952, valid_acc: 0.50, lr: 9.8797e-04, et: 0.0424
    epoch 007, train_loss: 0.5228, train_acc: 0.79, valid_loss: 0.7027, valid_acc: 0.50, lr: 9.8431e-04, et: 0.0420
    epoch 008, train_loss: 0.5344, train_acc: 0.79, valid_loss: 0.7097, valid_acc: 0.45, lr: 9.8017e-04, et: 0.0485
    epoch 009, train_loss: 0.5088, train_acc: 0.78, valid_loss: 0.7126, valid_acc: 0.47, lr: 9.7555e-04, et: 0.0425
    epoch 010, train_loss: 0.4393, train_acc: 0.85, valid_loss: 0.7183, valid_acc: 0.47, lr: 9.7047e-04, et: 0.0424
    epoch 011, train_loss: 0.4750, train_acc: 0.85, valid_loss: 0.7245, valid_acc: 0.47, lr: 9.6492e-04, et: 0.0423
    epoch 012, train_loss: 0.4280, train_acc: 0.88, valid_loss: 0.7246, valid_acc: 0.50, lr: 9.5892e-04, et: 0.0423
    epoch 013, train_loss: 0.4441, train_acc: 0.84, valid_loss: 0.7297, valid_acc: 0.55, lr: 9.5246e-04, et: 0.0423
    epoch 014, train_loss: 0.4551, train_acc: 0.81, valid_loss: 0.7447, valid_acc: 0.53, lr: 9.4556e-04, et: 0.0423
    epoch 015, train_loss: 0.3643, train_acc: 0.90, valid_loss: 0.7632, valid_acc: 0.50, lr: 9.3822e-04, et: 0.0423
    epoch 016, train_loss: 0.3837, train_acc: 0.88, valid_loss: 0.7633, valid_acc: 0.53, lr: 9.3044e-04, et: 0.0422
    epoch 017, train_loss: 0.3706, train_acc: 0.89, valid_loss: 0.7623, valid_acc: 0.53, lr: 9.2224e-04, et: 0.0422
    epoch 018, train_loss: 0.3530, train_acc: 0.89, valid_loss: 0.7633, valid_acc: 0.53, lr: 9.1363e-04, et: 0.0474
    epoch 019, train_loss: 0.3701, train_acc: 0.89, valid_loss: 0.7598, valid_acc: 0.55, lr: 9.0460e-04, et: 0.0433
    epoch 020, train_loss: 0.3128, train_acc: 0.93, valid_loss: 0.7702, valid_acc: 0.50, lr: 8.9518e-04, et: 0.0489
    epoch 021, train_loss: 0.2590, train_acc: 0.95, valid_loss: 0.7759, valid_acc: 0.50, lr: 8.8537e-04, et: 0.0424
    epoch 022, train_loss: 0.2903, train_acc: 0.93, valid_loss: 0.7806, valid_acc: 0.50, lr: 8.7518e-04, et: 0.0519
    epoch 023, train_loss: 0.2805, train_acc: 0.91, valid_loss: 0.7881, valid_acc: 0.55, lr: 8.6462e-04, et: 0.0481
    epoch 024, train_loss: 0.2927, train_acc: 0.90, valid_loss: 0.7947, valid_acc: 0.53, lr: 8.5370e-04, et: 0.0437
    epoch 025, train_loss: 0.2831, train_acc: 0.95, valid_loss: 0.7988, valid_acc: 0.53, lr: 8.4243e-04, et: 0.0441
    epoch 026, train_loss: 0.2564, train_acc: 0.94, valid_loss: 0.7758, valid_acc: 0.55, lr: 8.3083e-04, et: 0.0425
    epoch 027, train_loss: 0.2392, train_acc: 0.93, valid_loss: 0.7651, valid_acc: 0.57, lr: 8.1889e-04, et: 0.0429
    epoch 028, train_loss: 0.2169, train_acc: 0.96, valid_loss: 0.7739, valid_acc: 0.57, lr: 8.0665e-04, et: 0.0428
    epoch 029, train_loss: 0.1596, train_acc: 0.95, valid_loss: 0.7777, valid_acc: 0.60, lr: 7.9410e-04, et: 0.0543
    epoch 030, train_loss: 0.1719, train_acc: 0.97, valid_loss: 0.7968, valid_acc: 0.62, lr: 7.8126e-04, et: 0.1171
    epoch 031, train_loss: 0.1732, train_acc: 0.96, valid_loss: 0.7699, valid_acc: 0.60, lr: 7.6815e-04, et: 0.2081
    epoch 032, train_loss: 0.1538, train_acc: 0.97, valid_loss: 0.7849, valid_acc: 0.62, lr: 7.5477e-04, et: 0.0454
    epoch 033, train_loss: 0.1446, train_acc: 0.97, valid_loss: 0.7158, valid_acc: 0.65, lr: 7.4114e-04, et: 0.0429
    epoch 034, train_loss: 0.1642, train_acc: 0.95, valid_loss: 0.7149, valid_acc: 0.65, lr: 7.2727e-04, et: 0.0466
    epoch 035, train_loss: 0.1885, train_acc: 0.94, valid_loss: 0.7760, valid_acc: 0.60, lr: 7.1318e-04, et: 0.0443
    epoch 036, train_loss: 0.1268, train_acc: 0.97, valid_loss: 0.7649, valid_acc: 0.60, lr: 6.9888e-04, et: 0.0495
    epoch 037, train_loss: 0.1141, train_acc: 0.96, valid_loss: 0.6930, valid_acc: 0.65, lr: 6.8438e-04, et: 0.0457
    epoch 038, train_loss: 0.1288, train_acc: 0.96, valid_loss: 0.6519, valid_acc: 0.65, lr: 6.6970e-04, et: 0.0682, checkpoint saved
    epoch 039, train_loss: 0.1505, train_acc: 1.00, valid_loss: 0.6487, valid_acc: 0.68, lr: 6.5485e-04, et: 0.0905, checkpoint saved
    epoch 040, train_loss: 0.1071, train_acc: 0.99, valid_loss: 0.6502, valid_acc: 0.65, lr: 6.3986e-04, et: 0.0633
    epoch 041, train_loss: 0.1003, train_acc: 0.96, valid_loss: 0.6820, valid_acc: 0.65, lr: 6.2472e-04, et: 0.0737
    epoch 042, train_loss: 0.1188, train_acc: 0.97, valid_loss: 0.6893, valid_acc: 0.62, lr: 6.0946e-04, et: 0.1001
    epoch 043, train_loss: 0.0774, train_acc: 1.00, valid_loss: 0.5926, valid_acc: 0.65, lr: 5.9410e-04, et: 0.0851, checkpoint saved
    epoch 044, train_loss: 0.0765, train_acc: 0.99, valid_loss: 0.5484, valid_acc: 0.68, lr: 5.7864e-04, et: 0.0666, checkpoint saved
    epoch 045, train_loss: 0.0765, train_acc: 1.00, valid_loss: 0.5046, valid_acc: 0.70, lr: 5.6310e-04, et: 0.0712, checkpoint saved
    epoch 046, train_loss: 0.0714, train_acc: 0.99, valid_loss: 0.4840, valid_acc: 0.72, lr: 5.4751e-04, et: 0.0628, checkpoint saved
    epoch 047, train_loss: 0.0637, train_acc: 1.00, valid_loss: 0.4895, valid_acc: 0.70, lr: 5.3186e-04, et: 0.0665
    epoch 048, train_loss: 0.0533, train_acc: 1.00, valid_loss: 0.4948, valid_acc: 0.70, lr: 5.1619e-04, et: 0.0491
    epoch 049, train_loss: 0.0799, train_acc: 0.99, valid_loss: 0.4755, valid_acc: 0.72, lr: 5.0050e-04, et: 0.0431, checkpoint saved
    epoch 050, train_loss: 0.0762, train_acc: 0.99, valid_loss: 0.4553, valid_acc: 0.78, lr: 4.8481e-04, et: 0.0429, checkpoint saved
    epoch 051, train_loss: 0.0620, train_acc: 1.00, valid_loss: 0.4410, valid_acc: 0.80, lr: 4.6914e-04, et: 0.0431, checkpoint saved
    epoch 052, train_loss: 0.0565, train_acc: 1.00, valid_loss: 0.4277, valid_acc: 0.80, lr: 4.5349e-04, et: 0.0430, checkpoint saved
    epoch 053, train_loss: 0.0681, train_acc: 0.99, valid_loss: 0.4223, valid_acc: 0.82, lr: 4.3790e-04, et: 0.0427, checkpoint saved
    epoch 054, train_loss: 0.0712, train_acc: 0.99, valid_loss: 0.4344, valid_acc: 0.80, lr: 4.2236e-04, et: 0.0426
    epoch 055, train_loss: 0.1085, train_acc: 0.99, valid_loss: 0.4481, valid_acc: 0.78, lr: 4.0690e-04, et: 0.0426
    epoch 056, train_loss: 0.0452, train_acc: 1.00, valid_loss: 0.4786, valid_acc: 0.70, lr: 3.9154e-04, et: 0.0430
    epoch 057, train_loss: 0.0464, train_acc: 1.00, valid_loss: 0.4774, valid_acc: 0.70, lr: 3.7628e-04, et: 0.0439
    epoch 058, train_loss: 0.0587, train_acc: 0.99, valid_loss: 0.4595, valid_acc: 0.72, lr: 3.6114e-04, et: 0.0437
    epoch 059, train_loss: 0.0652, train_acc: 0.97, valid_loss: 0.4381, valid_acc: 0.75, lr: 3.4615e-04, et: 0.0436
    epoch 060, train_loss: 0.0649, train_acc: 0.97, valid_loss: 0.4311, valid_acc: 0.75, lr: 3.3130e-04, et: 0.0432
    epoch 061, train_loss: 0.0823, train_acc: 0.96, valid_loss: 0.4126, valid_acc: 0.78, lr: 3.1662e-04, et: 0.0424, checkpoint saved
    epoch 062, train_loss: 0.0614, train_acc: 0.97, valid_loss: 0.4216, valid_acc: 0.78, lr: 3.0212e-04, et: 0.0419
    epoch 063, train_loss: 0.0395, train_acc: 0.99, valid_loss: 0.4060, valid_acc: 0.78, lr: 2.8782e-04, et: 0.0482, checkpoint saved
    epoch 064, train_loss: 0.0491, train_acc: 1.00, valid_loss: 0.3713, valid_acc: 0.82, lr: 2.7373e-04, et: 0.0428, checkpoint saved
    epoch 065, train_loss: 0.1006, train_acc: 0.96, valid_loss: 0.3699, valid_acc: 0.82, lr: 2.5986e-04, et: 0.0425, checkpoint saved
    epoch 066, train_loss: 0.0297, train_acc: 1.00, valid_loss: 0.3658, valid_acc: 0.82, lr: 2.4623e-04, et: 0.0418, checkpoint saved
    epoch 067, train_loss: 0.0538, train_acc: 1.00, valid_loss: 0.3573, valid_acc: 0.82, lr: 2.3285e-04, et: 0.0417, checkpoint saved
    epoch 068, train_loss: 0.0569, train_acc: 1.00, valid_loss: 0.3486, valid_acc: 0.85, lr: 2.1974e-04, et: 0.0417, checkpoint saved
    epoch 069, train_loss: 0.0201, train_acc: 1.00, valid_loss: 0.3413, valid_acc: 0.85, lr: 2.0690e-04, et: 0.0420, checkpoint saved
    epoch 070, train_loss: 0.0382, train_acc: 1.00, valid_loss: 0.3311, valid_acc: 0.85, lr: 1.9435e-04, et: 0.0427, checkpoint saved
    epoch 071, train_loss: 0.0904, train_acc: 0.97, valid_loss: 0.3260, valid_acc: 0.85, lr: 1.8211e-04, et: 0.0425, checkpoint saved
    epoch 072, train_loss: 0.0598, train_acc: 0.97, valid_loss: 0.3269, valid_acc: 0.85, lr: 1.7017e-04, et: 0.0424
    epoch 073, train_loss: 0.0388, train_acc: 0.99, valid_loss: 0.3236, valid_acc: 0.85, lr: 1.5857e-04, et: 0.0423, checkpoint saved
    epoch 074, train_loss: 0.0591, train_acc: 0.99, valid_loss: 0.3223, valid_acc: 0.85, lr: 1.4730e-04, et: 0.0424, checkpoint saved
    epoch 075, train_loss: 0.0359, train_acc: 1.00, valid_loss: 0.3188, valid_acc: 0.85, lr: 1.3638e-04, et: 0.0423, checkpoint saved
    epoch 076, train_loss: 0.0538, train_acc: 0.99, valid_loss: 0.3124, valid_acc: 0.85, lr: 1.2582e-04, et: 0.0423, checkpoint saved
    epoch 077, train_loss: 0.0398, train_acc: 0.99, valid_loss: 0.3072, valid_acc: 0.85, lr: 1.1563e-04, et: 0.0457, checkpoint saved
    epoch 078, train_loss: 0.0372, train_acc: 1.00, valid_loss: 0.3039, valid_acc: 0.85, lr: 1.0582e-04, et: 0.0418, checkpoint saved
    epoch 079, train_loss: 0.0547, train_acc: 0.97, valid_loss: 0.3002, valid_acc: 0.85, lr: 9.6396e-05, et: 0.0418, checkpoint saved
    epoch 080, train_loss: 0.0204, train_acc: 1.00, valid_loss: 0.2955, valid_acc: 0.85, lr: 8.7373e-05, et: 0.0420, checkpoint saved
    epoch 081, train_loss: 0.0760, train_acc: 0.97, valid_loss: 0.2950, valid_acc: 0.85, lr: 7.8758e-05, et: 0.0424, checkpoint saved
    epoch 082, train_loss: 0.0247, train_acc: 1.00, valid_loss: 0.2948, valid_acc: 0.85, lr: 7.0559e-05, et: 0.0425, checkpoint saved
    epoch 083, train_loss: 0.0315, train_acc: 1.00, valid_loss: 0.2937, valid_acc: 0.85, lr: 6.2785e-05, et: 0.0425, checkpoint saved
    epoch 084, train_loss: 0.0615, train_acc: 1.00, valid_loss: 0.2922, valid_acc: 0.85, lr: 5.5442e-05, et: 0.0427, checkpoint saved
    epoch 085, train_loss: 0.0455, train_acc: 0.99, valid_loss: 0.2918, valid_acc: 0.85, lr: 4.8539e-05, et: 0.0427, checkpoint saved
    epoch 086, train_loss: 0.0560, train_acc: 1.00, valid_loss: 0.2927, valid_acc: 0.85, lr: 4.2082e-05, et: 0.0425
    epoch 087, train_loss: 0.0378, train_acc: 1.00, valid_loss: 0.2925, valid_acc: 0.85, lr: 3.6077e-05, et: 0.0424
    epoch 088, train_loss: 0.0289, train_acc: 1.00, valid_loss: 0.2917, valid_acc: 0.85, lr: 3.0530e-05, et: 0.0423, checkpoint saved
    epoch 089, train_loss: 0.0358, train_acc: 1.00, valid_loss: 0.2909, valid_acc: 0.85, lr: 2.5447e-05, et: 0.0423, checkpoint saved
    epoch 090, train_loss: 0.0718, train_acc: 0.97, valid_loss: 0.2894, valid_acc: 0.85, lr: 2.0833e-05, et: 0.0423, checkpoint saved
    epoch 091, train_loss: 0.0334, train_acc: 1.00, valid_loss: 0.2883, valid_acc: 0.85, lr: 1.6693e-05, et: 0.0423, checkpoint saved
    epoch 092, train_loss: 0.0269, train_acc: 1.00, valid_loss: 0.2878, valid_acc: 0.85, lr: 1.3030e-05, et: 0.0424, checkpoint saved
    epoch 093, train_loss: 0.0258, train_acc: 1.00, valid_loss: 0.2875, valid_acc: 0.85, lr: 9.8475e-06, et: 0.0423, checkpoint saved
    epoch 094, train_loss: 0.0523, train_acc: 0.99, valid_loss: 0.2868, valid_acc: 0.85, lr: 7.1497e-06, et: 0.0423, checkpoint saved
    epoch 095, train_loss: 0.0330, train_acc: 1.00, valid_loss: 0.2862, valid_acc: 0.85, lr: 4.9387e-06, et: 0.0432, checkpoint saved
    epoch 096, train_loss: 0.0489, train_acc: 1.00, valid_loss: 0.2860, valid_acc: 0.85, lr: 3.2168e-06, et: 0.0422, checkpoint saved
    epoch 097, train_loss: 0.0281, train_acc: 1.00, valid_loss: 0.2859, valid_acc: 0.85, lr: 1.9856e-06, et: 0.0422, checkpoint saved
    epoch 098, train_loss: 0.0662, train_acc: 0.97, valid_loss: 0.2860, valid_acc: 0.85, lr: 1.2465e-06, et: 0.0424
    epoch 099, train_loss: 0.0447, train_acc: 0.99, valid_loss: 0.2859, valid_acc: 0.85, lr: 1.0000e-06, et: 0.0423, checkpoint saved
    Elapsed Time: 4.97s
    0it [00:00, ?it/s]    9it [00:00, 42319.21it/s]
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    /home/skojima/git/rosoku/examples/02_deeplearning/01_example_test_reproducibility.py:78: RuntimeWarning: Concatenation of Annotations within Epochs is not supported yet. All annotations will be dropped.
      return mne.concatenate_epochs(epochs_list)
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    Not setting metadata
    80 matching events found
    No baseline correction applied
    0it [00:00, ?it/s]    9it [00:00, 42177.36it/s]
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    /home/skojima/git/rosoku/examples/02_deeplearning/01_example_test_reproducibility.py:78: RuntimeWarning: Concatenation of Annotations within Epochs is not supported yet. All annotations will be dropped.
      return mne.concatenate_epochs(epochs_list)
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0it [00:00, ?it/s]    9it [00:00, 40721.40it/s]
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    /home/skojima/git/rosoku/examples/02_deeplearning/01_example_test_reproducibility.py:78: RuntimeWarning: Concatenation of Annotations within Epochs is not supported yet. All annotations will be dropped.
      return mne.concatenate_epochs(epochs_list)
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    Not setting metadata
    80 matching events found
    No baseline correction applied
    epoch 000, train_loss: 0.6805, train_acc: 0.56, valid_loss: 0.6885, valid_acc: 0.55, lr: 9.9975e-04, et: 0.0430, checkpoint saved
    epoch 001, train_loss: 0.6759, train_acc: 0.61, valid_loss: 0.6886, valid_acc: 0.53, lr: 9.9901e-04, et: 0.0424
    epoch 002, train_loss: 0.6314, train_acc: 0.65, valid_loss: 0.6889, valid_acc: 0.53, lr: 9.9778e-04, et: 0.0423
    epoch 003, train_loss: 0.5853, train_acc: 0.76, valid_loss: 0.6895, valid_acc: 0.50, lr: 9.9606e-04, et: 0.0421
    epoch 004, train_loss: 0.6166, train_acc: 0.61, valid_loss: 0.6898, valid_acc: 0.50, lr: 9.9385e-04, et: 0.0424
    epoch 005, train_loss: 0.5462, train_acc: 0.82, valid_loss: 0.6913, valid_acc: 0.47, lr: 9.9115e-04, et: 0.0422
    epoch 006, train_loss: 0.5778, train_acc: 0.79, valid_loss: 0.6952, valid_acc: 0.50, lr: 9.8797e-04, et: 0.0458
    epoch 007, train_loss: 0.5228, train_acc: 0.79, valid_loss: 0.7027, valid_acc: 0.50, lr: 9.8431e-04, et: 0.0464
    epoch 008, train_loss: 0.5344, train_acc: 0.79, valid_loss: 0.7097, valid_acc: 0.45, lr: 9.8017e-04, et: 0.0427
    epoch 009, train_loss: 0.5088, train_acc: 0.78, valid_loss: 0.7126, valid_acc: 0.47, lr: 9.7555e-04, et: 0.0511
    epoch 010, train_loss: 0.4393, train_acc: 0.85, valid_loss: 0.7183, valid_acc: 0.47, lr: 9.7047e-04, et: 0.0534
    epoch 011, train_loss: 0.4750, train_acc: 0.85, valid_loss: 0.7245, valid_acc: 0.47, lr: 9.6492e-04, et: 0.0444
    epoch 012, train_loss: 0.4280, train_acc: 0.88, valid_loss: 0.7246, valid_acc: 0.50, lr: 9.5892e-04, et: 0.0425
    epoch 013, train_loss: 0.4441, train_acc: 0.84, valid_loss: 0.7297, valid_acc: 0.55, lr: 9.5246e-04, et: 0.0439
    epoch 014, train_loss: 0.4551, train_acc: 0.81, valid_loss: 0.7447, valid_acc: 0.53, lr: 9.4556e-04, et: 0.0424
    epoch 015, train_loss: 0.3643, train_acc: 0.90, valid_loss: 0.7632, valid_acc: 0.50, lr: 9.3822e-04, et: 0.0421
    epoch 016, train_loss: 0.3837, train_acc: 0.88, valid_loss: 0.7633, valid_acc: 0.53, lr: 9.3044e-04, et: 0.0566
    epoch 017, train_loss: 0.3706, train_acc: 0.89, valid_loss: 0.7623, valid_acc: 0.53, lr: 9.2224e-04, et: 0.1138
    epoch 018, train_loss: 0.3530, train_acc: 0.89, valid_loss: 0.7633, valid_acc: 0.53, lr: 9.1363e-04, et: 0.0770
    epoch 019, train_loss: 0.3701, train_acc: 0.89, valid_loss: 0.7598, valid_acc: 0.55, lr: 9.0460e-04, et: 0.0683
    epoch 020, train_loss: 0.3128, train_acc: 0.93, valid_loss: 0.7702, valid_acc: 0.50, lr: 8.9518e-04, et: 0.0653
    epoch 021, train_loss: 0.2590, train_acc: 0.95, valid_loss: 0.7759, valid_acc: 0.50, lr: 8.8537e-04, et: 0.0728
    epoch 022, train_loss: 0.2903, train_acc: 0.93, valid_loss: 0.7806, valid_acc: 0.50, lr: 8.7518e-04, et: 0.0954
    epoch 023, train_loss: 0.2805, train_acc: 0.91, valid_loss: 0.7881, valid_acc: 0.55, lr: 8.6462e-04, et: 0.0691
    epoch 024, train_loss: 0.2927, train_acc: 0.90, valid_loss: 0.7947, valid_acc: 0.53, lr: 8.5370e-04, et: 0.0689
    epoch 025, train_loss: 0.2831, train_acc: 0.95, valid_loss: 0.7988, valid_acc: 0.53, lr: 8.4243e-04, et: 0.0895
    epoch 026, train_loss: 0.2564, train_acc: 0.94, valid_loss: 0.7758, valid_acc: 0.55, lr: 8.3083e-04, et: 0.1023
    epoch 027, train_loss: 0.2392, train_acc: 0.93, valid_loss: 0.7651, valid_acc: 0.57, lr: 8.1889e-04, et: 0.0609
    epoch 028, train_loss: 0.2169, train_acc: 0.96, valid_loss: 0.7739, valid_acc: 0.57, lr: 8.0665e-04, et: 0.0428
    epoch 029, train_loss: 0.1596, train_acc: 0.95, valid_loss: 0.7777, valid_acc: 0.60, lr: 7.9410e-04, et: 0.0423
    epoch 030, train_loss: 0.1719, train_acc: 0.97, valid_loss: 0.7968, valid_acc: 0.62, lr: 7.8126e-04, et: 0.0460
    epoch 031, train_loss: 0.1732, train_acc: 0.96, valid_loss: 0.7699, valid_acc: 0.60, lr: 7.6815e-04, et: 0.0421
    epoch 032, train_loss: 0.1538, train_acc: 0.97, valid_loss: 0.7849, valid_acc: 0.62, lr: 7.5477e-04, et: 0.0419
    epoch 033, train_loss: 0.1446, train_acc: 0.97, valid_loss: 0.7158, valid_acc: 0.65, lr: 7.4114e-04, et: 0.0427
    epoch 034, train_loss: 0.1642, train_acc: 0.95, valid_loss: 0.7149, valid_acc: 0.65, lr: 7.2727e-04, et: 0.0422
    epoch 035, train_loss: 0.1885, train_acc: 0.94, valid_loss: 0.7760, valid_acc: 0.60, lr: 7.1318e-04, et: 0.0422
    epoch 036, train_loss: 0.1268, train_acc: 0.97, valid_loss: 0.7649, valid_acc: 0.60, lr: 6.9888e-04, et: 0.0421
    epoch 037, train_loss: 0.1141, train_acc: 0.96, valid_loss: 0.6930, valid_acc: 0.65, lr: 6.8438e-04, et: 0.0421
    epoch 038, train_loss: 0.1288, train_acc: 0.96, valid_loss: 0.6519, valid_acc: 0.65, lr: 6.6970e-04, et: 0.0422, checkpoint saved
    epoch 039, train_loss: 0.1505, train_acc: 1.00, valid_loss: 0.6487, valid_acc: 0.68, lr: 6.5485e-04, et: 0.0422, checkpoint saved
    epoch 040, train_loss: 0.1071, train_acc: 0.99, valid_loss: 0.6502, valid_acc: 0.65, lr: 6.3986e-04, et: 0.0422
    epoch 041, train_loss: 0.1003, train_acc: 0.96, valid_loss: 0.6820, valid_acc: 0.65, lr: 6.2472e-04, et: 0.0656
    epoch 042, train_loss: 0.1188, train_acc: 0.97, valid_loss: 0.6893, valid_acc: 0.62, lr: 6.0946e-04, et: 0.1007
    epoch 043, train_loss: 0.0774, train_acc: 1.00, valid_loss: 0.5926, valid_acc: 0.65, lr: 5.9410e-04, et: 0.0779, checkpoint saved
    epoch 044, train_loss: 0.0765, train_acc: 0.99, valid_loss: 0.5484, valid_acc: 0.68, lr: 5.7864e-04, et: 0.0464, checkpoint saved
    epoch 045, train_loss: 0.0765, train_acc: 1.00, valid_loss: 0.5046, valid_acc: 0.70, lr: 5.6310e-04, et: 0.0420, checkpoint saved
    epoch 046, train_loss: 0.0714, train_acc: 0.99, valid_loss: 0.4840, valid_acc: 0.72, lr: 5.4751e-04, et: 0.0418, checkpoint saved
    epoch 047, train_loss: 0.0637, train_acc: 1.00, valid_loss: 0.4895, valid_acc: 0.70, lr: 5.3186e-04, et: 0.0434
    epoch 048, train_loss: 0.0533, train_acc: 1.00, valid_loss: 0.4948, valid_acc: 0.70, lr: 5.1619e-04, et: 0.0490
    epoch 049, train_loss: 0.0799, train_acc: 0.99, valid_loss: 0.4755, valid_acc: 0.72, lr: 5.0050e-04, et: 0.0839, checkpoint saved
    epoch 050, train_loss: 0.0762, train_acc: 0.99, valid_loss: 0.4553, valid_acc: 0.78, lr: 4.8481e-04, et: 0.0493, checkpoint saved
    epoch 051, train_loss: 0.0620, train_acc: 1.00, valid_loss: 0.4410, valid_acc: 0.80, lr: 4.6914e-04, et: 0.0421, checkpoint saved
    epoch 052, train_loss: 0.0565, train_acc: 1.00, valid_loss: 0.4277, valid_acc: 0.80, lr: 4.5349e-04, et: 0.0810, checkpoint saved
    epoch 053, train_loss: 0.0681, train_acc: 0.99, valid_loss: 0.4223, valid_acc: 0.82, lr: 4.3790e-04, et: 0.0929, checkpoint saved
    epoch 054, train_loss: 0.0712, train_acc: 0.99, valid_loss: 0.4344, valid_acc: 0.80, lr: 4.2236e-04, et: 0.0548
    epoch 055, train_loss: 0.1085, train_acc: 0.99, valid_loss: 0.4481, valid_acc: 0.78, lr: 4.0690e-04, et: 0.0458
    epoch 056, train_loss: 0.0452, train_acc: 1.00, valid_loss: 0.4786, valid_acc: 0.70, lr: 3.9154e-04, et: 0.0424
    epoch 057, train_loss: 0.0464, train_acc: 1.00, valid_loss: 0.4774, valid_acc: 0.70, lr: 3.7628e-04, et: 0.0421
    epoch 058, train_loss: 0.0587, train_acc: 0.99, valid_loss: 0.4595, valid_acc: 0.72, lr: 3.6114e-04, et: 0.0421
    epoch 059, train_loss: 0.0652, train_acc: 0.97, valid_loss: 0.4381, valid_acc: 0.75, lr: 3.4615e-04, et: 0.0421
    epoch 060, train_loss: 0.0649, train_acc: 0.97, valid_loss: 0.4311, valid_acc: 0.75, lr: 3.3130e-04, et: 0.0421
    epoch 061, train_loss: 0.0823, train_acc: 0.96, valid_loss: 0.4126, valid_acc: 0.78, lr: 3.1662e-04, et: 0.0420, checkpoint saved
    epoch 062, train_loss: 0.0614, train_acc: 0.97, valid_loss: 0.4216, valid_acc: 0.78, lr: 3.0212e-04, et: 0.0423
    epoch 063, train_loss: 0.0395, train_acc: 0.99, valid_loss: 0.4060, valid_acc: 0.78, lr: 2.8782e-04, et: 0.0421, checkpoint saved
    epoch 064, train_loss: 0.0491, train_acc: 1.00, valid_loss: 0.3713, valid_acc: 0.82, lr: 2.7373e-04, et: 0.0421, checkpoint saved
    epoch 065, train_loss: 0.1006, train_acc: 0.96, valid_loss: 0.3699, valid_acc: 0.82, lr: 2.5986e-04, et: 0.0422, checkpoint saved
    epoch 066, train_loss: 0.0297, train_acc: 1.00, valid_loss: 0.3658, valid_acc: 0.82, lr: 2.4623e-04, et: 0.0421, checkpoint saved
    epoch 067, train_loss: 0.0538, train_acc: 1.00, valid_loss: 0.3573, valid_acc: 0.82, lr: 2.3285e-04, et: 0.0422, checkpoint saved
    epoch 068, train_loss: 0.0569, train_acc: 1.00, valid_loss: 0.3486, valid_acc: 0.85, lr: 2.1974e-04, et: 0.0421, checkpoint saved
    epoch 069, train_loss: 0.0201, train_acc: 1.00, valid_loss: 0.3413, valid_acc: 0.85, lr: 2.0690e-04, et: 0.0420, checkpoint saved
    epoch 070, train_loss: 0.0382, train_acc: 1.00, valid_loss: 0.3311, valid_acc: 0.85, lr: 1.9435e-04, et: 0.0421, checkpoint saved
    epoch 071, train_loss: 0.0904, train_acc: 0.97, valid_loss: 0.3260, valid_acc: 0.85, lr: 1.8211e-04, et: 0.0421, checkpoint saved
    epoch 072, train_loss: 0.0598, train_acc: 0.97, valid_loss: 0.3269, valid_acc: 0.85, lr: 1.7017e-04, et: 0.0421
    epoch 073, train_loss: 0.0388, train_acc: 0.99, valid_loss: 0.3236, valid_acc: 0.85, lr: 1.5857e-04, et: 0.0427, checkpoint saved
    epoch 074, train_loss: 0.0591, train_acc: 0.99, valid_loss: 0.3223, valid_acc: 0.85, lr: 1.4730e-04, et: 0.0422, checkpoint saved
    epoch 075, train_loss: 0.0359, train_acc: 1.00, valid_loss: 0.3188, valid_acc: 0.85, lr: 1.3638e-04, et: 0.0421, checkpoint saved
    epoch 076, train_loss: 0.0538, train_acc: 0.99, valid_loss: 0.3124, valid_acc: 0.85, lr: 1.2582e-04, et: 0.0421, checkpoint saved
    epoch 077, train_loss: 0.0398, train_acc: 0.99, valid_loss: 0.3072, valid_acc: 0.85, lr: 1.1563e-04, et: 0.0437, checkpoint saved
    epoch 078, train_loss: 0.0372, train_acc: 1.00, valid_loss: 0.3039, valid_acc: 0.85, lr: 1.0582e-04, et: 0.0433, checkpoint saved
    epoch 079, train_loss: 0.0547, train_acc: 0.97, valid_loss: 0.3002, valid_acc: 0.85, lr: 9.6396e-05, et: 0.0426, checkpoint saved
    epoch 080, train_loss: 0.0204, train_acc: 1.00, valid_loss: 0.2955, valid_acc: 0.85, lr: 8.7373e-05, et: 0.0416, checkpoint saved
    epoch 081, train_loss: 0.0760, train_acc: 0.97, valid_loss: 0.2950, valid_acc: 0.85, lr: 7.8758e-05, et: 0.0416, checkpoint saved
    epoch 082, train_loss: 0.0247, train_acc: 1.00, valid_loss: 0.2948, valid_acc: 0.85, lr: 7.0559e-05, et: 0.0415, checkpoint saved
    epoch 083, train_loss: 0.0315, train_acc: 1.00, valid_loss: 0.2937, valid_acc: 0.85, lr: 6.2785e-05, et: 0.0423, checkpoint saved
    epoch 084, train_loss: 0.0615, train_acc: 1.00, valid_loss: 0.2922, valid_acc: 0.85, lr: 5.5442e-05, et: 0.0421, checkpoint saved
    epoch 085, train_loss: 0.0455, train_acc: 0.99, valid_loss: 0.2918, valid_acc: 0.85, lr: 4.8539e-05, et: 0.0421, checkpoint saved
    epoch 086, train_loss: 0.0560, train_acc: 1.00, valid_loss: 0.2927, valid_acc: 0.85, lr: 4.2082e-05, et: 0.0425
    epoch 087, train_loss: 0.0378, train_acc: 1.00, valid_loss: 0.2925, valid_acc: 0.85, lr: 3.6077e-05, et: 0.0422
    epoch 088, train_loss: 0.0289, train_acc: 1.00, valid_loss: 0.2917, valid_acc: 0.85, lr: 3.0530e-05, et: 0.0422, checkpoint saved
    epoch 089, train_loss: 0.0358, train_acc: 1.00, valid_loss: 0.2909, valid_acc: 0.85, lr: 2.5447e-05, et: 0.0421, checkpoint saved
    epoch 090, train_loss: 0.0718, train_acc: 0.97, valid_loss: 0.2894, valid_acc: 0.85, lr: 2.0833e-05, et: 0.0421, checkpoint saved
    epoch 091, train_loss: 0.0334, train_acc: 1.00, valid_loss: 0.2883, valid_acc: 0.85, lr: 1.6693e-05, et: 0.0421, checkpoint saved
    epoch 092, train_loss: 0.0269, train_acc: 1.00, valid_loss: 0.2878, valid_acc: 0.85, lr: 1.3030e-05, et: 0.0491, checkpoint saved
    epoch 093, train_loss: 0.0258, train_acc: 1.00, valid_loss: 0.2875, valid_acc: 0.85, lr: 9.8475e-06, et: 0.0451, checkpoint saved
    epoch 094, train_loss: 0.0523, train_acc: 0.99, valid_loss: 0.2868, valid_acc: 0.85, lr: 7.1497e-06, et: 0.0447, checkpoint saved
    epoch 095, train_loss: 0.0330, train_acc: 1.00, valid_loss: 0.2862, valid_acc: 0.85, lr: 4.9387e-06, et: 0.0441, checkpoint saved
    epoch 096, train_loss: 0.0489, train_acc: 1.00, valid_loss: 0.2860, valid_acc: 0.85, lr: 3.2168e-06, et: 0.0441, checkpoint saved
    epoch 097, train_loss: 0.0281, train_acc: 1.00, valid_loss: 0.2859, valid_acc: 0.85, lr: 1.9856e-06, et: 0.0428, checkpoint saved
    epoch 098, train_loss: 0.0662, train_acc: 0.97, valid_loss: 0.2860, valid_acc: 0.85, lr: 1.2465e-06, et: 0.0451
    epoch 099, train_loss: 0.0447, train_acc: 0.99, valid_loss: 0.2859, valid_acc: 0.85, lr: 1.0000e-06, et: 0.0440, checkpoint saved
    Elapsed Time: 5.07s




.. GENERATED FROM PYTHON SOURCE LINES 178-180

Print Results
=============

.. GENERATED FROM PYTHON SOURCE LINES 180-190

.. code-block:: Python


    for results in results_list:
        print(results.to_string())

    is_identical = (
        results_list[0]["accuracy"].to_numpy()[0]
        == results_list[1]["accuracy"].to_numpy()[0]
    )

    print(f"is_identical: {is_identical}")




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

            items_train items_valid        items_test  accuracy   model  subject
    0  [56, "R1", "R2"]  [56, "R3"]  [56, "R4", "R5"]    0.9375  EEGNet       56
            items_train items_valid        items_test  accuracy   model  subject
    0  [56, "R1", "R2"]  [56, "R3"]  [56, "R4", "R5"]    0.9375  EEGNet       56
    is_identical: True





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 12.888 seconds)


.. _sphx_glr_download_auto_examples_02_deeplearning_01_example_test_reproducibility.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: 01_example_test_reproducibility.ipynb <01_example_test_reproducibility.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: 01_example_test_reproducibility.py <01_example_test_reproducibility.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: 01_example_test_reproducibility.zip <01_example_test_reproducibility.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
