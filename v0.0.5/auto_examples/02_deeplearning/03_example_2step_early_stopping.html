
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Example 03: 2-step Early Stopping &#8212; Rosoku 0.0.4 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=8c5712d9"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'auto_examples/02_deeplearning/03_example_2step_early_stopping';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://simonkojima.github.io/rosoku-docs/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '0.0.4';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="How to Install" href="../../install.html" />
    <link rel="prev" title="Example 02: Plot Saliency Map" href="02_example_plot_saliency_map.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo-light.png" class="logo__image only-light" alt="Rosoku 0.0.4 documentation - Home"/>
    <img src="../../_static/logo-dark.png" class="logo__image only-dark pst-js-only" alt="Rosoku 0.0.4 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../documentation.html">
    Documentation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../install.html">
    How to Install
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../documentation.html">
    Documentation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../install.html">
    How to Install
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../00_getting_started/index.html">Getting Started!!</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../00_getting_started/01_example_within-subject-classification-riemannian.html">Example 01: Within-subject classification with Riemannian classifier</a></li>




<li class="toctree-l2"><a class="reference internal" href="../00_getting_started/02_example_within-subject-classification-deeplearning.html">Example 02: Within-subject classification with deep learning</a></li>





<li class="toctree-l2"><a class="reference internal" href="../00_getting_started/03_example_cross-subject-classification-riemannian.html">Example 03: Cross-subject classification with Riemannian classifier</a></li>




<li class="toctree-l2"><a class="reference internal" href="../00_getting_started/04_example_cross-subject-classification-deeplearning.html">Example 04: Cross-subject classification with deep learning</a></li>






</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Deep Learning</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_example_test_reproducibility.html">Example 01: Testing Reproducibility of Deeplearning Experiments</a></li>





<li class="toctree-l2"><a class="reference internal" href="02_example_plot_saliency_map.html">Example 02: Plot Saliency Map</a></li>







<li class="toctree-l2 current active"><a class="current reference internal" href="#">Example 03: 2-step Early Stopping</a></li>






</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Examples</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Deep Learning</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Example 03: 2-step Early Stopping</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-02-deeplearning-03-example-2step-early-stopping-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="example-03-2-step-early-stopping">
<span id="sphx-glr-auto-examples-02-deeplearning-03-example-2step-early-stopping-py"></span><h1>Example 03: 2-step Early Stopping<a class="headerlink" href="#example-03-2-step-early-stopping" title="Link to this heading">#</a></h1>
<p>This example demonstrates a two-step training strategy using early stopping
with <code class="docutils literal notranslate"><span class="pre">rosoku</span></code> for deep-learning-based EEG classification.</p>
<p>The purpose of this example is to illustrate a practical way to estimate a
reasonable loss target and then use it to control the final training process,
while keeping the training loop unchanged.</p>
<p>The training is split into two stages:</p>
<ol class="arabic simple">
<li><p><strong>Step 1 (loss calibration / warm-up)</strong>:
A validation set is temporarily introduced and standard early stopping is
applied.
The goal of this step is to obtain a <strong>rough estimate of an achievable loss
value</strong> and a stable training regime.
The best loss value and corresponding checkpoint are stored.</p></li>
<li><p><strong>Step 2 (final training)</strong>:
The model is retrained using a larger training set that also includes the
former validation data.
Early stopping is now controlled by a custom <code class="docutils literal notranslate"><span class="pre">callback_early_stopping</span></code>
function, which stops training once the training loss reaches the best loss
observed in Step 1.</p></li>
</ol>
<p>This strategy is useful when:</p>
<ul class="simple">
<li><p>Early stopping is needed, but a permanent validation split is undesirable</p></li>
<li><p>One wants to <strong>maximize the amount of data used for final training</strong></p></li>
<li><p>A loss-based stopping criterion should be <strong>derived empirically</strong>
rather than hand-tuned</p></li>
</ul>
<p>Key aspects illustrated in this example include:</p>
<ul class="simple">
<li><p>Using validation loss only for <strong>loss calibration</strong></p></li>
<li><p>Custom early stopping via <code class="docutils literal notranslate"><span class="pre">callback_early_stopping</span></code></p></li>
<li><p>Reusing a loss threshold stored in a checkpoint</p></li>
<li><p>Implementing advanced stopping logic without modifying the training loop</p></li>
</ul>
<p>This example focuses on the <em>training strategy</em> rather than absolute performance,
and serves as a practical template for flexible early-stopping workflows in
<code class="docutils literal notranslate"><span class="pre">rosoku</span></code>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Authors: Simon Kojima &lt;simon.kojima@inria.fr&gt;</span>
<span class="c1">#</span>
<span class="c1"># License: BSD (3-clause)</span>
</pre></div>
</div>
</section>
<section id="set-environment-variables-for-replicability">
<h1>Set Environment Variables for Replicability<a class="headerlink" href="#set-environment-variables-for-replicability" title="Link to this heading">#</a></h1>
<p>NOTE:
This environment variable MUST be set <strong>before importing torch</strong>.
It enforces deterministic behavior in CUDA CuBLAS operations
when <cite>torch.use_deterministic_algorithms(True)</cite> is enabled.</p>
<p>See:
<a class="reference external" href="https://docs.nvidia.com/cuda/cublas/index.html#results-reproducibility">https://docs.nvidia.com/cuda/cublas/index.html#results-reproducibility</a></p>
<p>If this variable is set after importing torch, it will have no effect.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUBLAS_WORKSPACE_CONFIG&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;:4096:8&quot;</span>
</pre></div>
</div>
</section>
<section id="import-packages">
<h1>Import Packages<a class="headerlink" href="#import-packages" title="Link to this heading">#</a></h1>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">functools</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">mne</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">braindecode</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">rosoku</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">moabb.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dreyer2023</span>
</pre></div>
</div>
</section>
<section id="define-callback-functions">
<h1>Define callback functions<a class="headerlink" href="#define-callback-functions" title="Link to this heading">#</a></h1>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">callback_get_model</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">n_chans</span><span class="p">,</span> <span class="n">n_times</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">F1</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">D</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">F2</span> <span class="o">=</span> <span class="n">F1</span> <span class="o">*</span> <span class="n">D</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">braindecode</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">EEGNet</span><span class="p">(</span>
        <span class="n">n_chans</span><span class="o">=</span><span class="n">n_chans</span><span class="p">,</span>
        <span class="n">n_outputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">n_times</span><span class="o">=</span><span class="n">n_times</span><span class="p">,</span>
        <span class="n">F1</span><span class="o">=</span><span class="n">F1</span><span class="p">,</span>
        <span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">,</span>
        <span class="n">F2</span><span class="o">=</span><span class="n">F2</span><span class="p">,</span>
        <span class="n">drop_prob</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">model</span>


<span class="k">def</span><span class="w"> </span><span class="nf">callback_load_epochs</span><span class="p">(</span>
        <span class="n">items</span><span class="p">,</span> <span class="n">split</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">l_freq</span><span class="p">,</span> <span class="n">h_freq</span><span class="p">,</span> <span class="n">order_filter</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span>
<span class="p">):</span>
    <span class="n">subject</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">items</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="n">sessions</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">subjects</span><span class="o">=</span><span class="p">[</span><span class="n">subject</span><span class="p">])</span>
    <span class="n">raws_dict</span> <span class="o">=</span> <span class="n">sessions</span><span class="p">[</span><span class="n">subject</span><span class="p">][</span><span class="s2">&quot;0&quot;</span><span class="p">]</span>

    <span class="n">epochs_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">name_run</span><span class="p">,</span> <span class="n">raw</span> <span class="ow">in</span> <span class="n">raws_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="kc">True</span> <span class="ow">in</span> <span class="p">[</span><span class="n">item</span> <span class="ow">in</span> <span class="n">name_run</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">]:</span>
            <span class="k">continue</span>

        <span class="n">raw</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
            <span class="n">l_freq</span><span class="o">=</span><span class="n">l_freq</span><span class="p">,</span>
            <span class="n">h_freq</span><span class="o">=</span><span class="n">h_freq</span><span class="p">,</span>
            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;iir&quot;</span><span class="p">,</span>
            <span class="n">iir_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ftype&quot;</span><span class="p">:</span> <span class="s2">&quot;butter&quot;</span><span class="p">,</span> <span class="s2">&quot;order&quot;</span><span class="p">:</span> <span class="n">order_filter</span><span class="p">,</span> <span class="s2">&quot;btype&quot;</span><span class="p">:</span> <span class="s2">&quot;bandpass&quot;</span><span class="p">},</span>
        <span class="p">)</span>

        <span class="n">raw</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">pick</span><span class="p">(</span><span class="n">picks</span><span class="o">=</span><span class="s2">&quot;eeg&quot;</span><span class="p">)</span>

        <span class="n">epochs</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span>
            <span class="n">raw</span><span class="o">=</span><span class="n">raw</span><span class="p">,</span>
            <span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span>
            <span class="n">tmax</span><span class="o">=</span><span class="n">tmax</span><span class="p">,</span>
            <span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">epochs_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mne</span><span class="o">.</span><span class="n">concatenate_epochs</span><span class="p">(</span><span class="n">epochs_list</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">callback_proc_epochs</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">split</span><span class="p">):</span>
    <span class="c1"># do nothing in this example</span>
    <span class="k">return</span> <span class="n">epochs</span>


<span class="k">def</span><span class="w"> </span><span class="nf">convert_epochs_to_ndarray</span><span class="p">(</span>
        <span class="n">epochs</span><span class="p">,</span>
        <span class="n">split</span><span class="p">,</span>
        <span class="n">label_keys</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">epochs</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">rosoku</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_labels_from_epochs</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">label_keys</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
</section>
<section id="run-the-experiment-using-early-stopping-with-validation-data">
<h1>Run the Experiment using Early Stopping with Validation data<a class="headerlink" href="#run-the-experiment-using-early-stopping-with-validation-data" title="Link to this heading">#</a></h1>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">subject</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">resample</span> <span class="o">=</span> <span class="mi">128</span>

<span class="n">lr</span> <span class="o">=</span> <span class="mf">5e-4</span>
<span class="n">weight_decay</span> <span class="o">=</span> <span class="mf">1e-2</span>
<span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">patience</span> <span class="o">=</span> <span class="mi">75</span>
<span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;cuda&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span>

<span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">Dreyer2023</span><span class="p">()</span>

<span class="n">save_base</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;rosoku-log&quot;</span>
<span class="p">(</span><span class="n">save_base</span> <span class="o">/</span> <span class="s2">&quot;checkpoint&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">(</span><span class="n">save_base</span> <span class="o">/</span> <span class="s2">&quot;history&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">(</span><span class="n">save_base</span> <span class="o">/</span> <span class="s2">&quot;saliency&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">(</span><span class="n">save_base</span> <span class="o">/</span> <span class="s2">&quot;samples&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">(</span><span class="n">save_base</span> <span class="o">/</span> <span class="s2">&quot;normalization&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
<span class="n">scheduler</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">CosineAnnealingLR</span>
<span class="n">scheduler_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;T_max&quot;</span><span class="p">:</span> <span class="n">n_epochs</span><span class="p">,</span> <span class="s2">&quot;eta_min&quot;</span><span class="p">:</span> <span class="mf">1e-6</span><span class="p">}</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">AdamW</span>
<span class="n">optimizer_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="n">lr</span><span class="p">,</span> <span class="s2">&quot;weight_decay&quot;</span><span class="p">:</span> <span class="n">weight_decay</span><span class="p">}</span>
<span class="n">early_stopping</span> <span class="o">=</span> <span class="n">rosoku</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">patience</span><span class="o">=</span><span class="n">patience</span><span class="p">)</span>

<span class="n">label_keys</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;left_hand&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;right_hand&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>

<span class="n">results_1st_step</span> <span class="o">=</span> <span class="n">rosoku</span><span class="o">.</span><span class="n">deeplearning</span><span class="p">(</span>
    <span class="n">items_train</span><span class="o">=</span><span class="p">[</span><span class="n">subject</span><span class="p">,</span> <span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;R3&quot;</span><span class="p">],</span>
    <span class="n">items_valid</span><span class="o">=</span><span class="p">[</span><span class="n">subject</span><span class="p">,</span> <span class="s2">&quot;R4&quot;</span><span class="p">],</span>
    <span class="n">items_test</span><span class="o">=</span><span class="p">[[</span><span class="n">subject</span><span class="p">,</span> <span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;R6&quot;</span><span class="p">]],</span>
    <span class="n">callback_load_epochs</span><span class="o">=</span><span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
        <span class="n">callback_load_epochs</span><span class="p">,</span>
        <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
        <span class="n">l_freq</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span>
        <span class="n">h_freq</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span>
        <span class="n">order_filter</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
        <span class="n">tmin</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="n">tmax</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="n">callback_proc_epochs</span><span class="o">=</span><span class="n">callback_proc_epochs</span><span class="p">,</span>
    <span class="n">callback_convert_epochs_to_ndarray</span><span class="o">=</span><span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
        <span class="n">convert_epochs_to_ndarray</span><span class="p">,</span> <span class="n">label_keys</span><span class="o">=</span><span class="n">label_keys</span>
    <span class="p">),</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
    <span class="n">n_epochs</span><span class="o">=</span><span class="n">n_epochs</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">optimizer_params</span><span class="o">=</span><span class="n">optimizer_params</span><span class="p">,</span>
    <span class="n">callback_get_model</span><span class="o">=</span><span class="n">callback_get_model</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
    <span class="n">scheduler_params</span><span class="o">=</span><span class="n">scheduler_params</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
    <span class="n">early_stopping</span><span class="o">=</span><span class="n">early_stopping</span><span class="p">,</span>
    <span class="n">history_fname</span><span class="o">=</span><span class="p">(</span><span class="n">save_base</span> <span class="o">/</span> <span class="s2">&quot;history&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;sub-</span><span class="si">{</span><span class="n">subject</span><span class="si">}</span><span class="s2">.parquet&quot;</span><span class="p">),</span>
    <span class="n">checkpoint_fname</span><span class="o">=</span><span class="p">(</span><span class="n">save_base</span> <span class="o">/</span> <span class="s2">&quot;checkpoint&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;sub-</span><span class="si">{</span><span class="n">subject</span><span class="si">}</span><span class="s2">.pth&quot;</span><span class="p">),</span>
    <span class="n">samples_fname</span><span class="o">=</span><span class="p">(</span><span class="n">save_base</span> <span class="o">/</span> <span class="s2">&quot;samples&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;sub-</span><span class="si">{</span><span class="n">subject</span><span class="si">}</span><span class="s2">.parquet&quot;</span><span class="p">),</span>
    <span class="n">normalization_fname</span><span class="o">=</span><span class="p">(</span><span class="n">save_base</span> <span class="o">/</span> <span class="s2">&quot;normalization&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;sub-</span><span class="si">{</span><span class="n">subject</span><span class="si">}</span><span class="s2">.msgpack&quot;</span><span class="p">),</span>
    <span class="n">saliency_map_fname</span><span class="o">=</span><span class="p">(</span><span class="n">save_base</span> <span class="o">/</span> <span class="s2">&quot;saliency&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;sub-</span><span class="si">{</span><span class="n">subject</span><span class="si">}</span><span class="s2">.msgpack&quot;</span><span class="p">),</span>
    <span class="n">label_keys</span><span class="o">=</span><span class="n">label_keys</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
    <span class="n">additional_values</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="n">subject</span><span class="p">},</span>
    <span class="n">use_deterministic_algorithms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">min_delta</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>0it [00:00, ?it/s]
9it [00:00, 25837.60it/s]
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 8 - 30 Hz

IIR filter parameters
---------------------
Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
- Filter order 16 (effective, after forward-backward)
- Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

Used Annotations descriptions: [np.str_(&#39;left_hand&#39;), np.str_(&#39;right_hand&#39;)]
Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
Not setting metadata
40 matching events found
No baseline correction applied
0 projection items activated
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 8 - 30 Hz

IIR filter parameters
---------------------
Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
- Filter order 16 (effective, after forward-backward)
- Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

Used Annotations descriptions: [np.str_(&#39;left_hand&#39;), np.str_(&#39;right_hand&#39;)]
Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
Not setting metadata
40 matching events found
No baseline correction applied
0 projection items activated
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 8 - 30 Hz

IIR filter parameters
---------------------
Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
- Filter order 16 (effective, after forward-backward)
- Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

Used Annotations descriptions: [np.str_(&#39;left_hand&#39;), np.str_(&#39;right_hand&#39;)]
Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
Not setting metadata
40 matching events found
No baseline correction applied
0 projection items activated
/home/skojima/git/rosoku/examples/02_deeplearning/03_example_2step_early_stopping.py:135: RuntimeWarning: Concatenation of Annotations within Epochs is not supported yet. All annotations will be dropped.
  return mne.concatenate_epochs(epochs_list)
Using data from preloaded Raw for 40 events and 2305 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 40 events and 2305 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 40 events and 2305 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 40 events and 2305 original time points ...
Using data from preloaded Raw for 40 events and 2305 original time points ...
Using data from preloaded Raw for 40 events and 2305 original time points ...
Not setting metadata
120 matching events found
No baseline correction applied

0it [00:00, ?it/s]
9it [00:00, 24544.04it/s]
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 8 - 30 Hz

IIR filter parameters
---------------------
Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
- Filter order 16 (effective, after forward-backward)
- Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

Used Annotations descriptions: [np.str_(&#39;left_hand&#39;), np.str_(&#39;right_hand&#39;)]
Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
Not setting metadata
40 matching events found
No baseline correction applied
0 projection items activated
/home/skojima/git/rosoku/examples/02_deeplearning/03_example_2step_early_stopping.py:135: RuntimeWarning: Concatenation of Annotations within Epochs is not supported yet. All annotations will be dropped.
  return mne.concatenate_epochs(epochs_list)
Using data from preloaded Raw for 40 events and 2305 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 40 events and 2305 original time points ...
Not setting metadata
40 matching events found
No baseline correction applied

0it [00:00, ?it/s]
9it [00:00, 23666.92it/s]
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 8 - 30 Hz

IIR filter parameters
---------------------
Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
- Filter order 16 (effective, after forward-backward)
- Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

Used Annotations descriptions: [np.str_(&#39;left_hand&#39;), np.str_(&#39;right_hand&#39;)]
Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
Not setting metadata
40 matching events found
No baseline correction applied
0 projection items activated
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 8 - 30 Hz

IIR filter parameters
---------------------
Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
- Filter order 16 (effective, after forward-backward)
- Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

Used Annotations descriptions: [np.str_(&#39;left_hand&#39;), np.str_(&#39;right_hand&#39;)]
Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
Not setting metadata
40 matching events found
No baseline correction applied
0 projection items activated
/home/skojima/git/rosoku/examples/02_deeplearning/03_example_2step_early_stopping.py:135: RuntimeWarning: Concatenation of Annotations within Epochs is not supported yet. All annotations will be dropped.
  return mne.concatenate_epochs(epochs_list)
Using data from preloaded Raw for 40 events and 2305 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 40 events and 2305 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 40 events and 2305 original time points ...
Using data from preloaded Raw for 40 events and 2305 original time points ...
Not setting metadata
80 matching events found
No baseline correction applied
epoch 000, train_loss: 0.6935, train_acc: 0.52, valid_loss: 0.6919, valid_acc: 0.55, lr: 5.0000e-04, et: 0.0840, checkpoint saved
epoch 001, train_loss: 0.7118, train_acc: 0.51, valid_loss: 0.6909, valid_acc: 0.55, lr: 4.9998e-04, et: 0.0842, checkpoint saved
epoch 002, train_loss: 0.6905, train_acc: 0.53, valid_loss: 0.6903, valid_acc: 0.53, lr: 4.9996e-04, et: 0.0849, checkpoint saved
epoch 003, train_loss: 0.7005, train_acc: 0.50, valid_loss: 0.6885, valid_acc: 0.57, lr: 4.9992e-04, et: 0.0848, checkpoint saved
epoch 004, train_loss: 0.6518, train_acc: 0.64, valid_loss: 0.6875, valid_acc: 0.60, lr: 4.9988e-04, et: 0.0852, checkpoint saved
epoch 005, train_loss: 0.6430, train_acc: 0.64, valid_loss: 0.6870, valid_acc: 0.55, lr: 4.9982e-04, et: 0.0836, checkpoint saved
epoch 006, train_loss: 0.6361, train_acc: 0.65, valid_loss: 0.6852, valid_acc: 0.53, lr: 4.9976e-04, et: 0.0848, checkpoint saved
epoch 007, train_loss: 0.6441, train_acc: 0.62, valid_loss: 0.6849, valid_acc: 0.50, lr: 4.9968e-04, et: 0.0844, checkpoint saved
epoch 008, train_loss: 0.6243, train_acc: 0.69, valid_loss: 0.6821, valid_acc: 0.55, lr: 4.9960e-04, et: 0.0841, checkpoint saved
epoch 009, train_loss: 0.6226, train_acc: 0.67, valid_loss: 0.6805, valid_acc: 0.53, lr: 4.9951e-04, et: 0.0856, checkpoint saved
epoch 010, train_loss: 0.5925, train_acc: 0.73, valid_loss: 0.6803, valid_acc: 0.53, lr: 4.9940e-04, et: 0.0891, checkpoint saved
epoch 011, train_loss: 0.5997, train_acc: 0.70, valid_loss: 0.6773, valid_acc: 0.57, lr: 4.9929e-04, et: 0.0864, checkpoint saved
epoch 012, train_loss: 0.6108, train_acc: 0.72, valid_loss: 0.6761, valid_acc: 0.57, lr: 4.9917e-04, et: 0.0852, checkpoint saved
epoch 013, train_loss: 0.5780, train_acc: 0.75, valid_loss: 0.6744, valid_acc: 0.55, lr: 4.9904e-04, et: 0.0853, checkpoint saved
epoch 014, train_loss: 0.5828, train_acc: 0.71, valid_loss: 0.6730, valid_acc: 0.55, lr: 4.9889e-04, et: 0.0852, checkpoint saved
epoch 015, train_loss: 0.5600, train_acc: 0.78, valid_loss: 0.6732, valid_acc: 0.55, lr: 4.9874e-04, et: 0.0853
epoch 016, train_loss: 0.5654, train_acc: 0.76, valid_loss: 0.6732, valid_acc: 0.53, lr: 4.9858e-04, et: 0.0861
epoch 017, train_loss: 0.5820, train_acc: 0.70, valid_loss: 0.6721, valid_acc: 0.53, lr: 4.9841e-04, et: 0.0852, checkpoint saved
epoch 018, train_loss: 0.5466, train_acc: 0.76, valid_loss: 0.6740, valid_acc: 0.53, lr: 4.9822e-04, et: 0.0847
epoch 019, train_loss: 0.5575, train_acc: 0.78, valid_loss: 0.6723, valid_acc: 0.50, lr: 4.9803e-04, et: 0.0849
epoch 020, train_loss: 0.5163, train_acc: 0.82, valid_loss: 0.6687, valid_acc: 0.53, lr: 4.9783e-04, et: 0.0860, checkpoint saved
epoch 021, train_loss: 0.5281, train_acc: 0.75, valid_loss: 0.6713, valid_acc: 0.50, lr: 4.9762e-04, et: 0.0855
epoch 022, train_loss: 0.5265, train_acc: 0.78, valid_loss: 0.6707, valid_acc: 0.53, lr: 4.9740e-04, et: 0.0865
epoch 023, train_loss: 0.5258, train_acc: 0.82, valid_loss: 0.6685, valid_acc: 0.55, lr: 4.9717e-04, et: 0.0865, checkpoint saved
epoch 024, train_loss: 0.4992, train_acc: 0.84, valid_loss: 0.6681, valid_acc: 0.55, lr: 4.9693e-04, et: 0.0847, checkpoint saved
epoch 025, train_loss: 0.4989, train_acc: 0.82, valid_loss: 0.6713, valid_acc: 0.55, lr: 4.9668e-04, et: 0.0855
epoch 026, train_loss: 0.4908, train_acc: 0.78, valid_loss: 0.6700, valid_acc: 0.53, lr: 4.9642e-04, et: 0.0853
epoch 027, train_loss: 0.4803, train_acc: 0.78, valid_loss: 0.6681, valid_acc: 0.53, lr: 4.9615e-04, et: 0.0858, checkpoint saved
epoch 028, train_loss: 0.4684, train_acc: 0.80, valid_loss: 0.6698, valid_acc: 0.55, lr: 4.9587e-04, et: 0.0841
epoch 029, train_loss: 0.4993, train_acc: 0.76, valid_loss: 0.6751, valid_acc: 0.53, lr: 4.9558e-04, et: 0.0847
epoch 030, train_loss: 0.4648, train_acc: 0.87, valid_loss: 0.6764, valid_acc: 0.53, lr: 4.9528e-04, et: 0.0856
epoch 031, train_loss: 0.4433, train_acc: 0.85, valid_loss: 0.6741, valid_acc: 0.53, lr: 4.9497e-04, et: 0.0866
epoch 032, train_loss: 0.4930, train_acc: 0.81, valid_loss: 0.6707, valid_acc: 0.53, lr: 4.9466e-04, et: 0.0865
epoch 033, train_loss: 0.4459, train_acc: 0.84, valid_loss: 0.6686, valid_acc: 0.53, lr: 4.9433e-04, et: 0.0874
epoch 034, train_loss: 0.4675, train_acc: 0.83, valid_loss: 0.6673, valid_acc: 0.53, lr: 4.9399e-04, et: 0.0869, checkpoint saved
epoch 035, train_loss: 0.4132, train_acc: 0.86, valid_loss: 0.6784, valid_acc: 0.53, lr: 4.9364e-04, et: 0.0848
epoch 036, train_loss: 0.4611, train_acc: 0.82, valid_loss: 0.6818, valid_acc: 0.55, lr: 4.9329e-04, et: 0.0850
epoch 037, train_loss: 0.4612, train_acc: 0.82, valid_loss: 0.6881, valid_acc: 0.57, lr: 4.9292e-04, et: 0.0861
epoch 038, train_loss: 0.4527, train_acc: 0.83, valid_loss: 0.6851, valid_acc: 0.57, lr: 4.9255e-04, et: 0.0852
epoch 039, train_loss: 0.4350, train_acc: 0.82, valid_loss: 0.6818, valid_acc: 0.57, lr: 4.9216e-04, et: 0.0853
epoch 040, train_loss: 0.4099, train_acc: 0.82, valid_loss: 0.6836, valid_acc: 0.55, lr: 4.9177e-04, et: 0.0850
epoch 041, train_loss: 0.4221, train_acc: 0.82, valid_loss: 0.6777, valid_acc: 0.60, lr: 4.9136e-04, et: 0.0849
epoch 042, train_loss: 0.4111, train_acc: 0.83, valid_loss: 0.6817, valid_acc: 0.57, lr: 4.9095e-04, et: 0.0864
epoch 043, train_loss: 0.4289, train_acc: 0.78, valid_loss: 0.6825, valid_acc: 0.55, lr: 4.9053e-04, et: 0.0863
epoch 044, train_loss: 0.3554, train_acc: 0.89, valid_loss: 0.6822, valid_acc: 0.60, lr: 4.9009e-04, et: 0.0874
epoch 045, train_loss: 0.3693, train_acc: 0.89, valid_loss: 0.6854, valid_acc: 0.55, lr: 4.8965e-04, et: 0.0865
epoch 046, train_loss: 0.3929, train_acc: 0.80, valid_loss: 0.6901, valid_acc: 0.57, lr: 4.8920e-04, et: 0.0863
epoch 047, train_loss: 0.4205, train_acc: 0.89, valid_loss: 0.6856, valid_acc: 0.57, lr: 4.8874e-04, et: 0.0857
epoch 048, train_loss: 0.3476, train_acc: 0.88, valid_loss: 0.6829, valid_acc: 0.60, lr: 4.8827e-04, et: 0.0853
epoch 049, train_loss: 0.3805, train_acc: 0.89, valid_loss: 0.6844, valid_acc: 0.57, lr: 4.8779e-04, et: 0.0861
epoch 050, train_loss: 0.3386, train_acc: 0.88, valid_loss: 0.6836, valid_acc: 0.57, lr: 4.8730e-04, et: 0.0862
epoch 051, train_loss: 0.3670, train_acc: 0.88, valid_loss: 0.6805, valid_acc: 0.55, lr: 4.8680e-04, et: 0.0856
epoch 052, train_loss: 0.3289, train_acc: 0.93, valid_loss: 0.6686, valid_acc: 0.57, lr: 4.8629e-04, et: 0.0852
epoch 053, train_loss: 0.3614, train_acc: 0.88, valid_loss: 0.6626, valid_acc: 0.62, lr: 4.8578e-04, et: 0.0854, checkpoint saved
epoch 054, train_loss: 0.3258, train_acc: 0.89, valid_loss: 0.6667, valid_acc: 0.62, lr: 4.8525e-04, et: 0.0850
epoch 055, train_loss: 0.3692, train_acc: 0.88, valid_loss: 0.6724, valid_acc: 0.62, lr: 4.8471e-04, et: 0.0866
epoch 056, train_loss: 0.3319, train_acc: 0.93, valid_loss: 0.6648, valid_acc: 0.62, lr: 4.8417e-04, et: 0.0877
epoch 057, train_loss: 0.3155, train_acc: 0.84, valid_loss: 0.6504, valid_acc: 0.65, lr: 4.8362e-04, et: 0.0868, checkpoint saved
epoch 058, train_loss: 0.2880, train_acc: 0.93, valid_loss: 0.6552, valid_acc: 0.60, lr: 4.8305e-04, et: 0.0865
epoch 059, train_loss: 0.3115, train_acc: 0.88, valid_loss: 0.6422, valid_acc: 0.62, lr: 4.8248e-04, et: 0.0860, checkpoint saved
epoch 060, train_loss: 0.2572, train_acc: 0.90, valid_loss: 0.6202, valid_acc: 0.62, lr: 4.8190e-04, et: 0.0861, checkpoint saved
epoch 061, train_loss: 0.2708, train_acc: 0.93, valid_loss: 0.6021, valid_acc: 0.65, lr: 4.8131e-04, et: 0.0859, checkpoint saved
epoch 062, train_loss: 0.2782, train_acc: 0.91, valid_loss: 0.5950, valid_acc: 0.65, lr: 4.8071e-04, et: 0.0848, checkpoint saved
epoch 063, train_loss: 0.2766, train_acc: 0.90, valid_loss: 0.5877, valid_acc: 0.70, lr: 4.8010e-04, et: 0.0855, checkpoint saved
epoch 064, train_loss: 0.3059, train_acc: 0.89, valid_loss: 0.5932, valid_acc: 0.60, lr: 4.7948e-04, et: 0.0851
epoch 065, train_loss: 0.2851, train_acc: 0.92, valid_loss: 0.5710, valid_acc: 0.70, lr: 4.7885e-04, et: 0.0851, checkpoint saved
epoch 066, train_loss: 0.2151, train_acc: 0.95, valid_loss: 0.5432, valid_acc: 0.75, lr: 4.7822e-04, et: 0.0853, checkpoint saved
epoch 067, train_loss: 0.2484, train_acc: 0.92, valid_loss: 0.5274, valid_acc: 0.75, lr: 4.7757e-04, et: 0.0861, checkpoint saved
epoch 068, train_loss: 0.2155, train_acc: 0.97, valid_loss: 0.5066, valid_acc: 0.75, lr: 4.7692e-04, et: 0.0864, checkpoint saved
epoch 069, train_loss: 0.2332, train_acc: 0.93, valid_loss: 0.5041, valid_acc: 0.75, lr: 4.7625e-04, et: 0.0857, checkpoint saved
epoch 070, train_loss: 0.2506, train_acc: 0.92, valid_loss: 0.5072, valid_acc: 0.72, lr: 4.7558e-04, et: 0.0857
epoch 071, train_loss: 0.2285, train_acc: 0.94, valid_loss: 0.4766, valid_acc: 0.78, lr: 4.7490e-04, et: 0.0856, checkpoint saved
epoch 072, train_loss: 0.2241, train_acc: 0.93, valid_loss: 0.4608, valid_acc: 0.80, lr: 4.7421e-04, et: 0.0847, checkpoint saved
epoch 073, train_loss: 0.1946, train_acc: 0.90, valid_loss: 0.4505, valid_acc: 0.80, lr: 4.7351e-04, et: 0.0851, checkpoint saved
epoch 074, train_loss: 0.2009, train_acc: 0.95, valid_loss: 0.4485, valid_acc: 0.80, lr: 4.7281e-04, et: 0.0855, checkpoint saved
epoch 075, train_loss: 0.2072, train_acc: 0.93, valid_loss: 0.4441, valid_acc: 0.80, lr: 4.7209e-04, et: 0.0853, checkpoint saved
epoch 076, train_loss: 0.2156, train_acc: 0.92, valid_loss: 0.4271, valid_acc: 0.82, lr: 4.7137e-04, et: 0.0854, checkpoint saved
epoch 077, train_loss: 0.1885, train_acc: 0.92, valid_loss: 0.4286, valid_acc: 0.80, lr: 4.7063e-04, et: 0.0860
epoch 078, train_loss: 0.2088, train_acc: 0.90, valid_loss: 0.4280, valid_acc: 0.80, lr: 4.6989e-04, et: 0.0865
epoch 079, train_loss: 0.2066, train_acc: 0.93, valid_loss: 0.4296, valid_acc: 0.80, lr: 4.6914e-04, et: 0.0867
epoch 080, train_loss: 0.1776, train_acc: 0.97, valid_loss: 0.4304, valid_acc: 0.82, lr: 4.6838e-04, et: 0.0863
epoch 081, train_loss: 0.1735, train_acc: 0.95, valid_loss: 0.4554, valid_acc: 0.80, lr: 4.6761e-04, et: 0.0862
epoch 082, train_loss: 0.1546, train_acc: 0.97, valid_loss: 0.4370, valid_acc: 0.82, lr: 4.6683e-04, et: 0.0850
epoch 083, train_loss: 0.1750, train_acc: 0.95, valid_loss: 0.4440, valid_acc: 0.82, lr: 4.6605e-04, et: 0.0856
epoch 084, train_loss: 0.1635, train_acc: 0.96, valid_loss: 0.4408, valid_acc: 0.78, lr: 4.6526e-04, et: 0.0854
epoch 085, train_loss: 0.1872, train_acc: 0.93, valid_loss: 0.4512, valid_acc: 0.82, lr: 4.6445e-04, et: 0.0860
epoch 086, train_loss: 0.1397, train_acc: 0.96, valid_loss: 0.4507, valid_acc: 0.85, lr: 4.6364e-04, et: 0.0859
epoch 087, train_loss: 0.1872, train_acc: 0.93, valid_loss: 0.4434, valid_acc: 0.78, lr: 4.6282e-04, et: 0.0858
epoch 088, train_loss: 0.2085, train_acc: 0.92, valid_loss: 0.4473, valid_acc: 0.80, lr: 4.6200e-04, et: 0.0860
epoch 089, train_loss: 0.1489, train_acc: 0.96, valid_loss: 0.4467, valid_acc: 0.80, lr: 4.6116e-04, et: 0.0860
epoch 090, train_loss: 0.1448, train_acc: 0.97, valid_loss: 0.4417, valid_acc: 0.82, lr: 4.6032e-04, et: 0.0860
epoch 091, train_loss: 0.1283, train_acc: 0.97, valid_loss: 0.4416, valid_acc: 0.80, lr: 4.5946e-04, et: 0.0860
epoch 092, train_loss: 0.2164, train_acc: 0.92, valid_loss: 0.4442, valid_acc: 0.82, lr: 4.5860e-04, et: 0.0857
epoch 093, train_loss: 0.1698, train_acc: 0.93, valid_loss: 0.4430, valid_acc: 0.82, lr: 4.5773e-04, et: 0.0855
epoch 094, train_loss: 0.1412, train_acc: 0.96, valid_loss: 0.4486, valid_acc: 0.82, lr: 4.5686e-04, et: 0.0855
epoch 095, train_loss: 0.1821, train_acc: 0.93, valid_loss: 0.4440, valid_acc: 0.80, lr: 4.5597e-04, et: 0.0847
epoch 096, train_loss: 0.1335, train_acc: 0.97, valid_loss: 0.4523, valid_acc: 0.80, lr: 4.5508e-04, et: 0.0853
epoch 097, train_loss: 0.1261, train_acc: 0.97, valid_loss: 0.4561, valid_acc: 0.82, lr: 4.5418e-04, et: 0.0856
epoch 098, train_loss: 0.1136, train_acc: 0.97, valid_loss: 0.4369, valid_acc: 0.82, lr: 4.5327e-04, et: 0.0861
epoch 099, train_loss: 0.1164, train_acc: 0.95, valid_loss: 0.4555, valid_acc: 0.80, lr: 4.5235e-04, et: 0.0864
epoch 100, train_loss: 0.1327, train_acc: 0.96, valid_loss: 0.4294, valid_acc: 0.82, lr: 4.5142e-04, et: 0.0857
epoch 101, train_loss: 0.1430, train_acc: 0.94, valid_loss: 0.4340, valid_acc: 0.82, lr: 4.5049e-04, et: 0.0860
epoch 102, train_loss: 0.1215, train_acc: 0.96, valid_loss: 0.4290, valid_acc: 0.82, lr: 4.4955e-04, et: 0.0858
epoch 103, train_loss: 0.1466, train_acc: 0.94, valid_loss: 0.4292, valid_acc: 0.82, lr: 4.4860e-04, et: 0.0864
epoch 104, train_loss: 0.1065, train_acc: 0.97, valid_loss: 0.4220, valid_acc: 0.80, lr: 4.4764e-04, et: 0.0867, checkpoint saved
epoch 105, train_loss: 0.1152, train_acc: 0.97, valid_loss: 0.4182, valid_acc: 0.82, lr: 4.4668e-04, et: 0.0855, checkpoint saved
epoch 106, train_loss: 0.1094, train_acc: 0.97, valid_loss: 0.4026, valid_acc: 0.82, lr: 4.4571e-04, et: 0.0861, checkpoint saved
epoch 107, train_loss: 0.1004, train_acc: 0.97, valid_loss: 0.4073, valid_acc: 0.82, lr: 4.4473e-04, et: 0.0860
epoch 108, train_loss: 0.0991, train_acc: 0.97, valid_loss: 0.4167, valid_acc: 0.85, lr: 4.4374e-04, et: 0.0854
epoch 109, train_loss: 0.1230, train_acc: 0.95, valid_loss: 0.4170, valid_acc: 0.82, lr: 4.4274e-04, et: 0.0865
epoch 110, train_loss: 0.1295, train_acc: 0.96, valid_loss: 0.4016, valid_acc: 0.82, lr: 4.4174e-04, et: 0.0862, checkpoint saved
epoch 111, train_loss: 0.0946, train_acc: 0.97, valid_loss: 0.3944, valid_acc: 0.85, lr: 4.4073e-04, et: 0.0859, checkpoint saved
epoch 112, train_loss: 0.1458, train_acc: 0.95, valid_loss: 0.3933, valid_acc: 0.85, lr: 4.3971e-04, et: 0.0853, checkpoint saved
epoch 113, train_loss: 0.1361, train_acc: 0.97, valid_loss: 0.3808, valid_acc: 0.85, lr: 4.3869e-04, et: 0.0863, checkpoint saved
epoch 114, train_loss: 0.1325, train_acc: 0.96, valid_loss: 0.4017, valid_acc: 0.82, lr: 4.3765e-04, et: 0.0858
epoch 115, train_loss: 0.1557, train_acc: 0.93, valid_loss: 0.3739, valid_acc: 0.82, lr: 4.3661e-04, et: 0.0874, checkpoint saved
epoch 116, train_loss: 0.0883, train_acc: 0.98, valid_loss: 0.3747, valid_acc: 0.82, lr: 4.3556e-04, et: 0.0855
epoch 117, train_loss: 0.1269, train_acc: 0.96, valid_loss: 0.4115, valid_acc: 0.80, lr: 4.3451e-04, et: 0.0865
epoch 118, train_loss: 0.1183, train_acc: 0.96, valid_loss: 0.3993, valid_acc: 0.82, lr: 4.3345e-04, et: 0.0857
epoch 119, train_loss: 0.1253, train_acc: 0.97, valid_loss: 0.3969, valid_acc: 0.82, lr: 4.3238e-04, et: 0.0929
epoch 120, train_loss: 0.1132, train_acc: 0.97, valid_loss: 0.3956, valid_acc: 0.82, lr: 4.3130e-04, et: 0.0918
epoch 121, train_loss: 0.1955, train_acc: 0.91, valid_loss: 0.3920, valid_acc: 0.82, lr: 4.3022e-04, et: 0.0895
epoch 122, train_loss: 0.1235, train_acc: 0.97, valid_loss: 0.4008, valid_acc: 0.82, lr: 4.2913e-04, et: 0.0889
epoch 123, train_loss: 0.1113, train_acc: 0.95, valid_loss: 0.3868, valid_acc: 0.82, lr: 4.2803e-04, et: 0.0903
epoch 124, train_loss: 0.0636, train_acc: 0.98, valid_loss: 0.3810, valid_acc: 0.85, lr: 4.2692e-04, et: 0.0891
epoch 125, train_loss: 0.1030, train_acc: 0.96, valid_loss: 0.3772, valid_acc: 0.85, lr: 4.2581e-04, et: 0.0883
epoch 126, train_loss: 0.1122, train_acc: 0.95, valid_loss: 0.3855, valid_acc: 0.82, lr: 4.2469e-04, et: 0.0884
epoch 127, train_loss: 0.0859, train_acc: 0.98, valid_loss: 0.3833, valid_acc: 0.82, lr: 4.2357e-04, et: 0.0862
epoch 128, train_loss: 0.1038, train_acc: 0.96, valid_loss: 0.3789, valid_acc: 0.82, lr: 4.2243e-04, et: 0.0858
epoch 129, train_loss: 0.1138, train_acc: 0.97, valid_loss: 0.3737, valid_acc: 0.88, lr: 4.2129e-04, et: 0.0858, checkpoint saved
epoch 130, train_loss: 0.0965, train_acc: 0.95, valid_loss: 0.3687, valid_acc: 0.88, lr: 4.2015e-04, et: 0.0850, checkpoint saved
epoch 131, train_loss: 0.1291, train_acc: 0.94, valid_loss: 0.3673, valid_acc: 0.85, lr: 4.1900e-04, et: 0.0853, checkpoint saved
epoch 132, train_loss: 0.1411, train_acc: 0.95, valid_loss: 0.3680, valid_acc: 0.85, lr: 4.1784e-04, et: 0.0855
epoch 133, train_loss: 0.1317, train_acc: 0.94, valid_loss: 0.3733, valid_acc: 0.88, lr: 4.1667e-04, et: 0.0859
epoch 134, train_loss: 0.1039, train_acc: 0.95, valid_loss: 0.3819, valid_acc: 0.85, lr: 4.1550e-04, et: 0.0871
epoch 135, train_loss: 0.1405, train_acc: 0.95, valid_loss: 0.3624, valid_acc: 0.85, lr: 4.1432e-04, et: 0.0881, checkpoint saved
epoch 136, train_loss: 0.0907, train_acc: 0.97, valid_loss: 0.3554, valid_acc: 0.85, lr: 4.1313e-04, et: 0.0859, checkpoint saved
epoch 137, train_loss: 0.0681, train_acc: 0.98, valid_loss: 0.3517, valid_acc: 0.85, lr: 4.1194e-04, et: 0.0859, checkpoint saved
epoch 138, train_loss: 0.1010, train_acc: 0.95, valid_loss: 0.3552, valid_acc: 0.85, lr: 4.1074e-04, et: 0.0854
epoch 139, train_loss: 0.1474, train_acc: 0.94, valid_loss: 0.3629, valid_acc: 0.85, lr: 4.0954e-04, et: 0.0857
epoch 140, train_loss: 0.0999, train_acc: 0.95, valid_loss: 0.3663, valid_acc: 0.85, lr: 4.0833e-04, et: 0.0858
epoch 141, train_loss: 0.1267, train_acc: 0.97, valid_loss: 0.3591, valid_acc: 0.85, lr: 4.0711e-04, et: 0.0858
epoch 142, train_loss: 0.1306, train_acc: 0.97, valid_loss: 0.3602, valid_acc: 0.85, lr: 4.0589e-04, et: 0.0856
epoch 143, train_loss: 0.1017, train_acc: 0.97, valid_loss: 0.3727, valid_acc: 0.82, lr: 4.0466e-04, et: 0.0856
epoch 144, train_loss: 0.1217, train_acc: 0.95, valid_loss: 0.3620, valid_acc: 0.85, lr: 4.0342e-04, et: 0.0858
epoch 145, train_loss: 0.0775, train_acc: 0.97, valid_loss: 0.3592, valid_acc: 0.85, lr: 4.0218e-04, et: 0.0859
epoch 146, train_loss: 0.0762, train_acc: 0.98, valid_loss: 0.3556, valid_acc: 0.85, lr: 4.0093e-04, et: 0.0864
epoch 147, train_loss: 0.0836, train_acc: 0.98, valid_loss: 0.3511, valid_acc: 0.85, lr: 3.9968e-04, et: 0.0862, checkpoint saved
epoch 148, train_loss: 0.1474, train_acc: 0.94, valid_loss: 0.3809, valid_acc: 0.82, lr: 3.9842e-04, et: 0.0858
epoch 149, train_loss: 0.0590, train_acc: 0.99, valid_loss: 0.3853, valid_acc: 0.82, lr: 3.9715e-04, et: 0.0862
epoch 150, train_loss: 0.0842, train_acc: 0.97, valid_loss: 0.3563, valid_acc: 0.85, lr: 3.9588e-04, et: 0.0858
epoch 151, train_loss: 0.0919, train_acc: 0.97, valid_loss: 0.3545, valid_acc: 0.85, lr: 3.9460e-04, et: 0.0857
epoch 152, train_loss: 0.0741, train_acc: 0.98, valid_loss: 0.3585, valid_acc: 0.85, lr: 3.9332e-04, et: 0.0857
epoch 153, train_loss: 0.0915, train_acc: 0.97, valid_loss: 0.3500, valid_acc: 0.85, lr: 3.9203e-04, et: 0.0855, checkpoint saved
epoch 154, train_loss: 0.0714, train_acc: 0.98, valid_loss: 0.3498, valid_acc: 0.85, lr: 3.9074e-04, et: 0.0852, checkpoint saved
epoch 155, train_loss: 0.1017, train_acc: 0.96, valid_loss: 0.3560, valid_acc: 0.85, lr: 3.8944e-04, et: 0.0850
epoch 156, train_loss: 0.0784, train_acc: 0.97, valid_loss: 0.3431, valid_acc: 0.85, lr: 3.8814e-04, et: 0.0869, checkpoint saved
epoch 157, train_loss: 0.0755, train_acc: 0.97, valid_loss: 0.3391, valid_acc: 0.85, lr: 3.8683e-04, et: 0.0855, checkpoint saved
epoch 158, train_loss: 0.0673, train_acc: 0.98, valid_loss: 0.3389, valid_acc: 0.85, lr: 3.8551e-04, et: 0.0854, checkpoint saved
epoch 159, train_loss: 0.0732, train_acc: 0.97, valid_loss: 0.3453, valid_acc: 0.85, lr: 3.8419e-04, et: 0.0876
epoch 160, train_loss: 0.0798, train_acc: 0.97, valid_loss: 0.3414, valid_acc: 0.85, lr: 3.8286e-04, et: 0.0933
epoch 161, train_loss: 0.0879, train_acc: 0.97, valid_loss: 0.3337, valid_acc: 0.85, lr: 3.8153e-04, et: 0.0862, checkpoint saved
epoch 162, train_loss: 0.0694, train_acc: 0.98, valid_loss: 0.3297, valid_acc: 0.85, lr: 3.8019e-04, et: 0.0858, checkpoint saved
epoch 163, train_loss: 0.0481, train_acc: 1.00, valid_loss: 0.3390, valid_acc: 0.85, lr: 3.7885e-04, et: 0.0853
epoch 164, train_loss: 0.1049, train_acc: 0.96, valid_loss: 0.3453, valid_acc: 0.85, lr: 3.7751e-04, et: 0.0856
epoch 165, train_loss: 0.1262, train_acc: 0.96, valid_loss: 0.3411, valid_acc: 0.88, lr: 3.7615e-04, et: 0.0869
epoch 166, train_loss: 0.0900, train_acc: 0.97, valid_loss: 0.3457, valid_acc: 0.88, lr: 3.7480e-04, et: 0.0868
epoch 167, train_loss: 0.0701, train_acc: 0.98, valid_loss: 0.3424, valid_acc: 0.85, lr: 3.7344e-04, et: 0.0871
epoch 168, train_loss: 0.0699, train_acc: 0.97, valid_loss: 0.3345, valid_acc: 0.88, lr: 3.7207e-04, et: 0.0893
epoch 169, train_loss: 0.0662, train_acc: 0.99, valid_loss: 0.3415, valid_acc: 0.88, lr: 3.7070e-04, et: 0.0876
epoch 170, train_loss: 0.0605, train_acc: 0.98, valid_loss: 0.3453, valid_acc: 0.88, lr: 3.6932e-04, et: 0.0877
epoch 171, train_loss: 0.0630, train_acc: 0.97, valid_loss: 0.3435, valid_acc: 0.85, lr: 3.6794e-04, et: 0.0868
epoch 172, train_loss: 0.0703, train_acc: 0.97, valid_loss: 0.3458, valid_acc: 0.85, lr: 3.6656e-04, et: 0.0868
epoch 173, train_loss: 0.0701, train_acc: 0.98, valid_loss: 0.3337, valid_acc: 0.85, lr: 3.6517e-04, et: 0.0858
epoch 174, train_loss: 0.0601, train_acc: 0.97, valid_loss: 0.3226, valid_acc: 0.85, lr: 3.6377e-04, et: 0.0852, checkpoint saved
epoch 175, train_loss: 0.0512, train_acc: 0.98, valid_loss: 0.3191, valid_acc: 0.85, lr: 3.6237e-04, et: 0.0855, checkpoint saved
epoch 176, train_loss: 0.0727, train_acc: 0.98, valid_loss: 0.3216, valid_acc: 0.88, lr: 3.6097e-04, et: 0.0852
epoch 177, train_loss: 0.0755, train_acc: 0.98, valid_loss: 0.3327, valid_acc: 0.88, lr: 3.5956e-04, et: 0.0860
epoch 178, train_loss: 0.0739, train_acc: 0.97, valid_loss: 0.3355, valid_acc: 0.88, lr: 3.5815e-04, et: 0.0861
epoch 179, train_loss: 0.0559, train_acc: 0.99, valid_loss: 0.3307, valid_acc: 0.88, lr: 3.5673e-04, et: 0.0864
epoch 180, train_loss: 0.1155, train_acc: 0.95, valid_loss: 0.3071, valid_acc: 0.88, lr: 3.5531e-04, et: 0.0867, checkpoint saved
epoch 181, train_loss: 0.0888, train_acc: 0.97, valid_loss: 0.3166, valid_acc: 0.88, lr: 3.5389e-04, et: 0.0857
epoch 182, train_loss: 0.0617, train_acc: 0.97, valid_loss: 0.3205, valid_acc: 0.88, lr: 3.5246e-04, et: 0.0866
epoch 183, train_loss: 0.0868, train_acc: 0.97, valid_loss: 0.3196, valid_acc: 0.88, lr: 3.5103e-04, et: 0.0860
epoch 184, train_loss: 0.0844, train_acc: 0.96, valid_loss: 0.3102, valid_acc: 0.85, lr: 3.4959e-04, et: 0.0859
epoch 185, train_loss: 0.0497, train_acc: 0.99, valid_loss: 0.3045, valid_acc: 0.88, lr: 3.4815e-04, et: 0.0877, checkpoint saved
epoch 186, train_loss: 0.0618, train_acc: 0.99, valid_loss: 0.3019, valid_acc: 0.85, lr: 3.4670e-04, et: 0.0859, checkpoint saved
epoch 187, train_loss: 0.0848, train_acc: 0.98, valid_loss: 0.3075, valid_acc: 0.85, lr: 3.4525e-04, et: 0.0848
epoch 188, train_loss: 0.0519, train_acc: 0.98, valid_loss: 0.3104, valid_acc: 0.85, lr: 3.4380e-04, et: 0.0862
epoch 189, train_loss: 0.0591, train_acc: 0.99, valid_loss: 0.3105, valid_acc: 0.88, lr: 3.4235e-04, et: 0.0873
epoch 190, train_loss: 0.0979, train_acc: 0.97, valid_loss: 0.3207, valid_acc: 0.88, lr: 3.4089e-04, et: 0.0876
epoch 191, train_loss: 0.0674, train_acc: 0.97, valid_loss: 0.3158, valid_acc: 0.88, lr: 3.3942e-04, et: 0.0871
epoch 192, train_loss: 0.0951, train_acc: 0.97, valid_loss: 0.3231, valid_acc: 0.88, lr: 3.3796e-04, et: 0.0857
epoch 193, train_loss: 0.0766, train_acc: 0.98, valid_loss: 0.3239, valid_acc: 0.88, lr: 3.3649e-04, et: 0.0882
epoch 194, train_loss: 0.0607, train_acc: 0.97, valid_loss: 0.3274, valid_acc: 0.85, lr: 3.3502e-04, et: 0.0884
epoch 195, train_loss: 0.1083, train_acc: 0.97, valid_loss: 0.3343, valid_acc: 0.85, lr: 3.3354e-04, et: 0.0885
epoch 196, train_loss: 0.0923, train_acc: 0.97, valid_loss: 0.3223, valid_acc: 0.88, lr: 3.3206e-04, et: 0.0896
epoch 197, train_loss: 0.0593, train_acc: 0.99, valid_loss: 0.3094, valid_acc: 0.88, lr: 3.3058e-04, et: 0.0876
epoch 198, train_loss: 0.0444, train_acc: 0.99, valid_loss: 0.3032, valid_acc: 0.88, lr: 3.2909e-04, et: 0.0881
epoch 199, train_loss: 0.1106, train_acc: 0.97, valid_loss: 0.3136, valid_acc: 0.88, lr: 3.2760e-04, et: 0.0892
epoch 200, train_loss: 0.0546, train_acc: 0.99, valid_loss: 0.3170, valid_acc: 0.88, lr: 3.2611e-04, et: 0.0878
epoch 201, train_loss: 0.0839, train_acc: 0.96, valid_loss: 0.3126, valid_acc: 0.88, lr: 3.2461e-04, et: 0.0857
epoch 202, train_loss: 0.0653, train_acc: 0.97, valid_loss: 0.3047, valid_acc: 0.85, lr: 3.2311e-04, et: 0.0870
epoch 203, train_loss: 0.0879, train_acc: 0.96, valid_loss: 0.3072, valid_acc: 0.85, lr: 3.2161e-04, et: 0.0878
epoch 204, train_loss: 0.0492, train_acc: 1.00, valid_loss: 0.3029, valid_acc: 0.85, lr: 3.2011e-04, et: 0.0874
epoch 205, train_loss: 0.0440, train_acc: 0.99, valid_loss: 0.2962, valid_acc: 0.85, lr: 3.1860e-04, et: 0.0863, checkpoint saved
epoch 206, train_loss: 0.0684, train_acc: 0.97, valid_loss: 0.3071, valid_acc: 0.85, lr: 3.1709e-04, et: 0.0858
epoch 207, train_loss: 0.0704, train_acc: 0.99, valid_loss: 0.3117, valid_acc: 0.88, lr: 3.1558e-04, et: 0.0855
epoch 208, train_loss: 0.0340, train_acc: 0.99, valid_loss: 0.3062, valid_acc: 0.85, lr: 3.1407e-04, et: 0.0864
epoch 209, train_loss: 0.0753, train_acc: 0.96, valid_loss: 0.2984, valid_acc: 0.85, lr: 3.1255e-04, et: 0.0855
epoch 210, train_loss: 0.0627, train_acc: 0.99, valid_loss: 0.3112, valid_acc: 0.85, lr: 3.1103e-04, et: 0.0860
epoch 211, train_loss: 0.1101, train_acc: 0.96, valid_loss: 0.3202, valid_acc: 0.85, lr: 3.0951e-04, et: 0.0862
epoch 212, train_loss: 0.0528, train_acc: 0.97, valid_loss: 0.3232, valid_acc: 0.85, lr: 3.0798e-04, et: 0.0865
epoch 213, train_loss: 0.0626, train_acc: 0.98, valid_loss: 0.3265, valid_acc: 0.88, lr: 3.0646e-04, et: 0.0861
epoch 214, train_loss: 0.0830, train_acc: 0.96, valid_loss: 0.3241, valid_acc: 0.88, lr: 3.0493e-04, et: 0.0865
epoch 215, train_loss: 0.0873, train_acc: 0.96, valid_loss: 0.3076, valid_acc: 0.85, lr: 3.0340e-04, et: 0.0865
epoch 216, train_loss: 0.0710, train_acc: 0.97, valid_loss: 0.3104, valid_acc: 0.85, lr: 3.0186e-04, et: 0.0867
epoch 217, train_loss: 0.0783, train_acc: 0.97, valid_loss: 0.3113, valid_acc: 0.85, lr: 3.0033e-04, et: 0.0859
epoch 218, train_loss: 0.0425, train_acc: 0.99, valid_loss: 0.3132, valid_acc: 0.85, lr: 2.9879e-04, et: 0.0859
epoch 219, train_loss: 0.0599, train_acc: 0.99, valid_loss: 0.3260, valid_acc: 0.85, lr: 2.9725e-04, et: 0.0862
epoch 220, train_loss: 0.1257, train_acc: 0.93, valid_loss: 0.3342, valid_acc: 0.88, lr: 2.9571e-04, et: 0.0866
epoch 221, train_loss: 0.0461, train_acc: 0.99, valid_loss: 0.3415, valid_acc: 0.90, lr: 2.9417e-04, et: 0.0860
epoch 222, train_loss: 0.1065, train_acc: 0.96, valid_loss: 0.3446, valid_acc: 0.88, lr: 2.9262e-04, et: 0.0863
epoch 223, train_loss: 0.0772, train_acc: 0.98, valid_loss: 0.3439, valid_acc: 0.90, lr: 2.9108e-04, et: 0.0864
epoch 224, train_loss: 0.0544, train_acc: 0.98, valid_loss: 0.3376, valid_acc: 0.85, lr: 2.8953e-04, et: 0.0870
epoch 225, train_loss: 0.1092, train_acc: 0.96, valid_loss: 0.3399, valid_acc: 0.85, lr: 2.8798e-04, et: 0.0868
epoch 226, train_loss: 0.0506, train_acc: 0.99, valid_loss: 0.3407, valid_acc: 0.88, lr: 2.8643e-04, et: 0.0876
epoch 227, train_loss: 0.0571, train_acc: 0.99, valid_loss: 0.3318, valid_acc: 0.85, lr: 2.8488e-04, et: 0.0859
epoch 228, train_loss: 0.0748, train_acc: 0.97, valid_loss: 0.3446, valid_acc: 0.88, lr: 2.8333e-04, et: 0.0869
epoch 229, train_loss: 0.0530, train_acc: 0.99, valid_loss: 0.3407, valid_acc: 0.88, lr: 2.8177e-04, et: 0.0857
epoch 230, train_loss: 0.0397, train_acc: 1.00, valid_loss: 0.3376, valid_acc: 0.88, lr: 2.8021e-04, et: 0.0879
epoch 231, train_loss: 0.0698, train_acc: 0.97, valid_loss: 0.3291, valid_acc: 0.88, lr: 2.7866e-04, et: 0.0857
epoch 232, train_loss: 0.1207, train_acc: 0.95, valid_loss: 0.3293, valid_acc: 0.85, lr: 2.7710e-04, et: 0.0857
epoch 233, train_loss: 0.0458, train_acc: 0.99, valid_loss: 0.3239, valid_acc: 0.85, lr: 2.7554e-04, et: 0.0857
epoch 234, train_loss: 0.0734, train_acc: 0.97, valid_loss: 0.3291, valid_acc: 0.88, lr: 2.7398e-04, et: 0.0857
epoch 235, train_loss: 0.0621, train_acc: 0.98, valid_loss: 0.3235, valid_acc: 0.88, lr: 2.7242e-04, et: 0.0859
epoch 236, train_loss: 0.0285, train_acc: 1.00, valid_loss: 0.3183, valid_acc: 0.88, lr: 2.7086e-04, et: 0.0864
epoch 237, train_loss: 0.0544, train_acc: 0.98, valid_loss: 0.3163, valid_acc: 0.88, lr: 2.6929e-04, et: 0.0861
epoch 238, train_loss: 0.1008, train_acc: 0.95, valid_loss: 0.3090, valid_acc: 0.85, lr: 2.6773e-04, et: 0.0853
epoch 239, train_loss: 0.0558, train_acc: 0.97, valid_loss: 0.3098, valid_acc: 0.85, lr: 2.6617e-04, et: 0.0864
epoch 240, train_loss: 0.1244, train_acc: 0.93, valid_loss: 0.3134, valid_acc: 0.85, lr: 2.6460e-04, et: 0.0855
epoch 241, train_loss: 0.0565, train_acc: 0.99, valid_loss: 0.3129, valid_acc: 0.85, lr: 2.6304e-04, et: 0.0857
epoch 242, train_loss: 0.0566, train_acc: 0.97, valid_loss: 0.3101, valid_acc: 0.85, lr: 2.6147e-04, et: 0.0859
epoch 243, train_loss: 0.1618, train_acc: 0.94, valid_loss: 0.3322, valid_acc: 0.88, lr: 2.5990e-04, et: 0.0860
epoch 244, train_loss: 0.0928, train_acc: 0.97, valid_loss: 0.3277, valid_acc: 0.88, lr: 2.5834e-04, et: 0.0856
epoch 245, train_loss: 0.0764, train_acc: 0.96, valid_loss: 0.3170, valid_acc: 0.85, lr: 2.5677e-04, et: 0.0864
epoch 246, train_loss: 0.0486, train_acc: 0.99, valid_loss: 0.3183, valid_acc: 0.85, lr: 2.5520e-04, et: 0.0861
epoch 247, train_loss: 0.0341, train_acc: 0.99, valid_loss: 0.3169, valid_acc: 0.85, lr: 2.5364e-04, et: 0.0877
epoch 248, train_loss: 0.0379, train_acc: 0.99, valid_loss: 0.3266, valid_acc: 0.85, lr: 2.5207e-04, et: 0.0867
epoch 249, train_loss: 0.0581, train_acc: 0.98, valid_loss: 0.3305, valid_acc: 0.85, lr: 2.5050e-04, et: 0.0864
epoch 250, train_loss: 0.0403, train_acc: 0.99, valid_loss: 0.3338, valid_acc: 0.85, lr: 2.4893e-04, et: 0.0863
epoch 251, train_loss: 0.0605, train_acc: 0.98, valid_loss: 0.3244, valid_acc: 0.85, lr: 2.4736e-04, et: 0.0877
epoch 252, train_loss: 0.0536, train_acc: 0.99, valid_loss: 0.3202, valid_acc: 0.85, lr: 2.4580e-04, et: 0.0874
epoch 253, train_loss: 0.1111, train_acc: 0.95, valid_loss: 0.3185, valid_acc: 0.85, lr: 2.4423e-04, et: 0.0882
epoch 254, train_loss: 0.0404, train_acc: 0.99, valid_loss: 0.3265, valid_acc: 0.85, lr: 2.4266e-04, et: 0.0894
epoch 255, train_loss: 0.0483, train_acc: 0.97, valid_loss: 0.3272, valid_acc: 0.85, lr: 2.4110e-04, et: 0.0872
epoch 256, train_loss: 0.0569, train_acc: 0.97, valid_loss: 0.3286, valid_acc: 0.85, lr: 2.3953e-04, et: 0.0878
epoch 257, train_loss: 0.0397, train_acc: 0.99, valid_loss: 0.3326, valid_acc: 0.85, lr: 2.3796e-04, et: 0.0884
epoch 258, train_loss: 0.0439, train_acc: 0.98, valid_loss: 0.3345, valid_acc: 0.85, lr: 2.3640e-04, et: 0.0882
epoch 259, train_loss: 0.1165, train_acc: 0.95, valid_loss: 0.3320, valid_acc: 0.85, lr: 2.3483e-04, et: 0.0889
epoch 260, train_loss: 0.1107, train_acc: 0.94, valid_loss: 0.3275, valid_acc: 0.85, lr: 2.3327e-04, et: 0.0867
epoch 261, train_loss: 0.0664, train_acc: 0.98, valid_loss: 0.3197, valid_acc: 0.85, lr: 2.3171e-04, et: 0.0861
epoch 262, train_loss: 0.0932, train_acc: 0.97, valid_loss: 0.3169, valid_acc: 0.85, lr: 2.3014e-04, et: 0.0881
epoch 263, train_loss: 0.0510, train_acc: 0.98, valid_loss: 0.3186, valid_acc: 0.85, lr: 2.2858e-04, et: 0.0869
epoch 264, train_loss: 0.0651, train_acc: 0.97, valid_loss: 0.3180, valid_acc: 0.85, lr: 2.2702e-04, et: 0.0863
epoch 265, train_loss: 0.0479, train_acc: 0.99, valid_loss: 0.3202, valid_acc: 0.85, lr: 2.2546e-04, et: 0.0857
epoch 266, train_loss: 0.0446, train_acc: 0.98, valid_loss: 0.3275, valid_acc: 0.85, lr: 2.2390e-04, et: 0.0862
epoch 267, train_loss: 0.1088, train_acc: 0.96, valid_loss: 0.3239, valid_acc: 0.85, lr: 2.2234e-04, et: 0.0855
epoch 268, train_loss: 0.0911, train_acc: 0.97, valid_loss: 0.3244, valid_acc: 0.85, lr: 2.2079e-04, et: 0.0868
epoch 269, train_loss: 0.0752, train_acc: 0.98, valid_loss: 0.3197, valid_acc: 0.85, lr: 2.1923e-04, et: 0.0869
epoch 270, train_loss: 0.0392, train_acc: 1.00, valid_loss: 0.3214, valid_acc: 0.88, lr: 2.1767e-04, et: 0.0868
epoch 271, train_loss: 0.0293, train_acc: 1.00, valid_loss: 0.3158, valid_acc: 0.85, lr: 2.1612e-04, et: 0.0866
epoch 272, train_loss: 0.0656, train_acc: 0.97, valid_loss: 0.3145, valid_acc: 0.85, lr: 2.1457e-04, et: 0.0855
epoch 273, train_loss: 0.0516, train_acc: 0.98, valid_loss: 0.3101, valid_acc: 0.88, lr: 2.1302e-04, et: 0.0861
epoch 274, train_loss: 0.0726, train_acc: 0.97, valid_loss: 0.3098, valid_acc: 0.85, lr: 2.1147e-04, et: 0.0859
epoch 275, train_loss: 0.0463, train_acc: 0.98, valid_loss: 0.3086, valid_acc: 0.85, lr: 2.0992e-04, et: 0.0871
epoch 276, train_loss: 0.0881, train_acc: 0.96, valid_loss: 0.3017, valid_acc: 0.85, lr: 2.0838e-04, et: 0.0864
epoch 277, train_loss: 0.0487, train_acc: 0.98, valid_loss: 0.3099, valid_acc: 0.85, lr: 2.0683e-04, et: 0.0864
epoch 278, train_loss: 0.0469, train_acc: 0.99, valid_loss: 0.3114, valid_acc: 0.85, lr: 2.0529e-04, et: 0.0855
epoch 279, train_loss: 0.0355, train_acc: 0.99, valid_loss: 0.3113, valid_acc: 0.85, lr: 2.0375e-04, et: 0.0862
epoch 280, train_loss: 0.0613, train_acc: 0.98, valid_loss: 0.3107, valid_acc: 0.85, lr: 2.0221e-04, et: 0.0868
Early stopping was triggered: epoch #281
Elapsed Time: 24.46s
</pre></div>
</div>
</section>
<section id="run-the-experiment-using-early-stopping-with-callback-early-stopping">
<h1>Run the Experiment using Early Stopping with callback_early_stopping<a class="headerlink" href="#run-the-experiment-using-early-stopping-with-callback-early-stopping" title="Link to this heading">#</a></h1>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">save_base</span> <span class="o">/</span> <span class="s2">&quot;checkpoint&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;sub-</span><span class="si">{</span><span class="n">subject</span><span class="si">}</span><span class="s2">.pth&quot;</span><span class="p">)</span>
<span class="n">loss_best</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;loss_best&quot;</span><span class="p">]</span>

<span class="n">lr</span> <span class="o">=</span> <span class="mf">5e-4</span>
<span class="n">weight_decay</span> <span class="o">=</span> <span class="mf">1e-2</span>
<span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>

<span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
<span class="n">scheduler</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">CosineAnnealingLR</span>
<span class="n">scheduler_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;T_max&quot;</span><span class="p">:</span> <span class="n">n_epochs</span><span class="p">,</span> <span class="s2">&quot;eta_min&quot;</span><span class="p">:</span> <span class="mf">1e-6</span><span class="p">}</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">AdamW</span>
<span class="n">optimizer_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="n">lr</span><span class="p">,</span> <span class="s2">&quot;weight_decay&quot;</span><span class="p">:</span> <span class="n">weight_decay</span><span class="p">}</span>
<span class="n">early_stopping</span> <span class="o">=</span> <span class="n">rosoku</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">patience</span><span class="o">=</span><span class="n">patience</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">callback_early_stopping</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
    <span class="c1"># Stop training once the training loss reaches the best</span>
    <span class="c1"># validation loss obtained in the first step</span>
    <span class="k">return</span> <span class="n">state</span><span class="p">[</span><span class="s2">&quot;train_loss&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">loss_best</span>


<span class="n">results_2nd_step</span> <span class="o">=</span> <span class="n">rosoku</span><span class="o">.</span><span class="n">deeplearning</span><span class="p">(</span>
    <span class="n">items_train</span><span class="o">=</span><span class="p">[</span><span class="n">subject</span><span class="p">,</span> <span class="s2">&quot;R1&quot;</span><span class="p">,</span> <span class="s2">&quot;R2&quot;</span><span class="p">,</span> <span class="s2">&quot;R3&quot;</span><span class="p">,</span> <span class="s2">&quot;R4&quot;</span><span class="p">],</span>
    <span class="n">items_valid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">items_test</span><span class="o">=</span><span class="p">[[</span><span class="n">subject</span><span class="p">,</span> <span class="s2">&quot;R5&quot;</span><span class="p">,</span> <span class="s2">&quot;R6&quot;</span><span class="p">]],</span>
    <span class="n">callback_load_epochs</span><span class="o">=</span><span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
        <span class="n">callback_load_epochs</span><span class="p">,</span>
        <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
        <span class="n">l_freq</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span>
        <span class="n">h_freq</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span>
        <span class="n">order_filter</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
        <span class="n">tmin</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="n">tmax</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">),</span>
    <span class="n">callback_proc_epochs</span><span class="o">=</span><span class="n">callback_proc_epochs</span><span class="p">,</span>
    <span class="n">callback_convert_epochs_to_ndarray</span><span class="o">=</span><span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
        <span class="n">convert_epochs_to_ndarray</span><span class="p">,</span> <span class="n">label_keys</span><span class="o">=</span><span class="n">label_keys</span>
    <span class="p">),</span>
    <span class="n">callback_early_stopping</span><span class="o">=</span><span class="n">callback_early_stopping</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
    <span class="n">n_epochs</span><span class="o">=</span><span class="n">n_epochs</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">optimizer_params</span><span class="o">=</span><span class="n">optimizer_params</span><span class="p">,</span>
    <span class="n">callback_get_model</span><span class="o">=</span><span class="n">callback_get_model</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
    <span class="n">scheduler_params</span><span class="o">=</span><span class="n">scheduler_params</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
    <span class="n">history_fname</span><span class="o">=</span><span class="p">(</span><span class="n">save_base</span> <span class="o">/</span> <span class="s2">&quot;history&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;sub-</span><span class="si">{</span><span class="n">subject</span><span class="si">}</span><span class="s2">_2nd.parquet&quot;</span><span class="p">),</span>
    <span class="n">checkpoint_fname</span><span class="o">=</span><span class="p">(</span><span class="n">save_base</span> <span class="o">/</span> <span class="s2">&quot;checkpoint&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;sub-</span><span class="si">{</span><span class="n">subject</span><span class="si">}</span><span class="s2">_2nd.pth&quot;</span><span class="p">),</span>
    <span class="n">samples_fname</span><span class="o">=</span><span class="p">(</span><span class="n">save_base</span> <span class="o">/</span> <span class="s2">&quot;samples&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;sub-</span><span class="si">{</span><span class="n">subject</span><span class="si">}</span><span class="s2">_2nd.parquet&quot;</span><span class="p">),</span>
    <span class="n">normalization_fname</span><span class="o">=</span><span class="p">(</span><span class="n">save_base</span> <span class="o">/</span> <span class="s2">&quot;normalization&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;sub-</span><span class="si">{</span><span class="n">subject</span><span class="si">}</span><span class="s2">_2nd.msgpack&quot;</span><span class="p">),</span>
    <span class="n">saliency_map_fname</span><span class="o">=</span><span class="p">(</span><span class="n">save_base</span> <span class="o">/</span> <span class="s2">&quot;saliency&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;sub-</span><span class="si">{</span><span class="n">subject</span><span class="si">}</span><span class="s2">_2nd.msgpack&quot;</span><span class="p">),</span>
    <span class="n">label_keys</span><span class="o">=</span><span class="n">label_keys</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
    <span class="n">additional_values</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="n">subject</span><span class="p">},</span>
    <span class="n">use_deterministic_algorithms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">min_delta</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>0it [00:00, ?it/s]
9it [00:00, 19045.78it/s]
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 8 - 30 Hz

IIR filter parameters
---------------------
Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
- Filter order 16 (effective, after forward-backward)
- Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

Used Annotations descriptions: [np.str_(&#39;left_hand&#39;), np.str_(&#39;right_hand&#39;)]
Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
Not setting metadata
40 matching events found
No baseline correction applied
0 projection items activated
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 8 - 30 Hz

IIR filter parameters
---------------------
Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
- Filter order 16 (effective, after forward-backward)
- Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

Used Annotations descriptions: [np.str_(&#39;left_hand&#39;), np.str_(&#39;right_hand&#39;)]
Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
Not setting metadata
40 matching events found
No baseline correction applied
0 projection items activated
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 8 - 30 Hz

IIR filter parameters
---------------------
Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
- Filter order 16 (effective, after forward-backward)
- Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

Used Annotations descriptions: [np.str_(&#39;left_hand&#39;), np.str_(&#39;right_hand&#39;)]
Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
Not setting metadata
40 matching events found
No baseline correction applied
0 projection items activated
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 8 - 30 Hz

IIR filter parameters
---------------------
Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
- Filter order 16 (effective, after forward-backward)
- Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

Used Annotations descriptions: [np.str_(&#39;left_hand&#39;), np.str_(&#39;right_hand&#39;)]
Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
Not setting metadata
40 matching events found
No baseline correction applied
0 projection items activated
/home/skojima/git/rosoku/examples/02_deeplearning/03_example_2step_early_stopping.py:135: RuntimeWarning: Concatenation of Annotations within Epochs is not supported yet. All annotations will be dropped.
  return mne.concatenate_epochs(epochs_list)
Using data from preloaded Raw for 40 events and 2305 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 40 events and 2305 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 40 events and 2305 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 40 events and 2305 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 40 events and 2305 original time points ...
Using data from preloaded Raw for 40 events and 2305 original time points ...
Using data from preloaded Raw for 40 events and 2305 original time points ...
Using data from preloaded Raw for 40 events and 2305 original time points ...
Not setting metadata
160 matching events found
No baseline correction applied

0it [00:00, ?it/s]
9it [00:00, 25961.99it/s]
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Reading 0 ... 230911  =      0.000 ...   450.998 secs...
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 8 - 30 Hz

IIR filter parameters
---------------------
Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
- Filter order 16 (effective, after forward-backward)
- Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

Used Annotations descriptions: [np.str_(&#39;left_hand&#39;), np.str_(&#39;right_hand&#39;)]
Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
Not setting metadata
40 matching events found
No baseline correction applied
0 projection items activated
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 8 - 30 Hz

IIR filter parameters
---------------------
Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
- Filter order 16 (effective, after forward-backward)
- Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

Used Annotations descriptions: [np.str_(&#39;left_hand&#39;), np.str_(&#39;right_hand&#39;)]
Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
Not setting metadata
40 matching events found
No baseline correction applied
0 projection items activated
/home/skojima/git/rosoku/examples/02_deeplearning/03_example_2step_early_stopping.py:135: RuntimeWarning: Concatenation of Annotations within Epochs is not supported yet. All annotations will be dropped.
  return mne.concatenate_epochs(epochs_list)
Using data from preloaded Raw for 40 events and 2305 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 40 events and 2305 original time points ...
0 bad epochs dropped
Using data from preloaded Raw for 40 events and 2305 original time points ...
Using data from preloaded Raw for 40 events and 2305 original time points ...
Not setting metadata
80 matching events found
No baseline correction applied
epoch 000, train_loss: 0.7105, train_acc: 0.52, lr: 5.0000e-04, et: 0.0998, checkpoint saved
epoch 001, train_loss: 0.6965, train_acc: 0.56, lr: 4.9998e-04, et: 0.1063, checkpoint saved
epoch 002, train_loss: 0.7049, train_acc: 0.51, lr: 4.9996e-04, et: 0.1053
epoch 003, train_loss: 0.6524, train_acc: 0.61, lr: 4.9992e-04, et: 0.1053, checkpoint saved
epoch 004, train_loss: 0.6686, train_acc: 0.57, lr: 4.9988e-04, et: 0.1056
epoch 005, train_loss: 0.6484, train_acc: 0.66, lr: 4.9982e-04, et: 0.1049, checkpoint saved
epoch 006, train_loss: 0.6618, train_acc: 0.58, lr: 4.9976e-04, et: 0.1044
epoch 007, train_loss: 0.6324, train_acc: 0.64, lr: 4.9968e-04, et: 0.1027, checkpoint saved
epoch 008, train_loss: 0.6132, train_acc: 0.71, lr: 4.9960e-04, et: 0.1083, checkpoint saved
epoch 009, train_loss: 0.6281, train_acc: 0.66, lr: 4.9951e-04, et: 0.1064
epoch 010, train_loss: 0.6005, train_acc: 0.69, lr: 4.9940e-04, et: 0.1087, checkpoint saved
epoch 011, train_loss: 0.5957, train_acc: 0.69, lr: 4.9929e-04, et: 0.1047, checkpoint saved
epoch 012, train_loss: 0.5753, train_acc: 0.74, lr: 4.9917e-04, et: 0.1056, checkpoint saved
epoch 013, train_loss: 0.5746, train_acc: 0.69, lr: 4.9904e-04, et: 0.1040, checkpoint saved
epoch 014, train_loss: 0.5603, train_acc: 0.72, lr: 4.9889e-04, et: 0.1075, checkpoint saved
epoch 015, train_loss: 0.5558, train_acc: 0.74, lr: 4.9874e-04, et: 0.1054, checkpoint saved
epoch 016, train_loss: 0.5669, train_acc: 0.71, lr: 4.9858e-04, et: 0.1061
epoch 017, train_loss: 0.5287, train_acc: 0.80, lr: 4.9841e-04, et: 0.1058, checkpoint saved
epoch 018, train_loss: 0.5283, train_acc: 0.75, lr: 4.9822e-04, et: 0.1034, checkpoint saved
epoch 019, train_loss: 0.5251, train_acc: 0.78, lr: 4.9803e-04, et: 0.1029, checkpoint saved
epoch 020, train_loss: 0.5451, train_acc: 0.74, lr: 4.9783e-04, et: 0.1026
epoch 021, train_loss: 0.5368, train_acc: 0.74, lr: 4.9762e-04, et: 0.1033
epoch 022, train_loss: 0.4721, train_acc: 0.84, lr: 4.9740e-04, et: 0.1028, checkpoint saved
epoch 023, train_loss: 0.5082, train_acc: 0.78, lr: 4.9717e-04, et: 0.1018
epoch 024, train_loss: 0.4918, train_acc: 0.81, lr: 4.9693e-04, et: 0.1041
epoch 025, train_loss: 0.5186, train_acc: 0.75, lr: 4.9668e-04, et: 0.1029
epoch 026, train_loss: 0.4986, train_acc: 0.78, lr: 4.9642e-04, et: 0.1074
epoch 027, train_loss: 0.5027, train_acc: 0.80, lr: 4.9615e-04, et: 0.1044
epoch 028, train_loss: 0.4537, train_acc: 0.83, lr: 4.9587e-04, et: 0.1039, checkpoint saved
epoch 029, train_loss: 0.4795, train_acc: 0.78, lr: 4.9558e-04, et: 0.1040
epoch 030, train_loss: 0.4866, train_acc: 0.75, lr: 4.9528e-04, et: 0.1039
epoch 031, train_loss: 0.4843, train_acc: 0.76, lr: 4.9497e-04, et: 0.1028
epoch 032, train_loss: 0.4709, train_acc: 0.79, lr: 4.9466e-04, et: 0.1026
epoch 033, train_loss: 0.4606, train_acc: 0.80, lr: 4.9433e-04, et: 0.1033
epoch 034, train_loss: 0.4201, train_acc: 0.81, lr: 4.9399e-04, et: 0.1043, checkpoint saved
epoch 035, train_loss: 0.4478, train_acc: 0.84, lr: 4.9364e-04, et: 0.1035
epoch 036, train_loss: 0.4328, train_acc: 0.79, lr: 4.9329e-04, et: 0.1045
epoch 037, train_loss: 0.4451, train_acc: 0.82, lr: 4.9292e-04, et: 0.1043
epoch 038, train_loss: 0.4361, train_acc: 0.78, lr: 4.9255e-04, et: 0.1042
epoch 039, train_loss: 0.3984, train_acc: 0.88, lr: 4.9216e-04, et: 0.1033, checkpoint saved
epoch 040, train_loss: 0.4506, train_acc: 0.80, lr: 4.9177e-04, et: 0.1022
epoch 041, train_loss: 0.3781, train_acc: 0.86, lr: 4.9136e-04, et: 0.1024, checkpoint saved
epoch 042, train_loss: 0.4048, train_acc: 0.81, lr: 4.9095e-04, et: 0.1024
epoch 043, train_loss: 0.4138, train_acc: 0.82, lr: 4.9053e-04, et: 0.1043
epoch 044, train_loss: 0.3629, train_acc: 0.89, lr: 4.9009e-04, et: 0.1036, checkpoint saved
epoch 045, train_loss: 0.3680, train_acc: 0.87, lr: 4.8965e-04, et: 0.1046
epoch 046, train_loss: 0.3763, train_acc: 0.86, lr: 4.8920e-04, et: 0.1046
epoch 047, train_loss: 0.3296, train_acc: 0.89, lr: 4.8874e-04, et: 0.1044, checkpoint saved
epoch 048, train_loss: 0.3395, train_acc: 0.88, lr: 4.8827e-04, et: 0.1037
epoch 049, train_loss: 0.3028, train_acc: 0.91, lr: 4.8779e-04, et: 0.1036, checkpoint saved
epoch 050, train_loss: 0.3573, train_acc: 0.84, lr: 4.8730e-04, et: 0.1028
epoch 051, train_loss: 0.3531, train_acc: 0.87, lr: 4.8680e-04, et: 0.1030
epoch 052, train_loss: 0.3275, train_acc: 0.88, lr: 4.8629e-04, et: 0.1030
epoch 053, train_loss: 0.2517, train_acc: 0.92, lr: 4.8578e-04, et: 0.1035, checkpoint saved
Early stopping was triggered: epoch #54
Elapsed Time: 5.71s
</pre></div>
</div>
</section>
<section id="print-results">
<h1>Print Results<a class="headerlink" href="#print-results" title="Link to this heading">#</a></h1>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">results_1st_step</span><span class="o">.</span><span class="n">to_string</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_2nd_step</span><span class="o">.</span><span class="n">to_string</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>              items_train items_valid        items_test  accuracy   model  subject
0  [10, &quot;R1&quot;, &quot;R2&quot;, &quot;R3&quot;]  [10, &quot;R4&quot;]  [10, &quot;R5&quot;, &quot;R6&quot;]    0.8375  EEGNet       10
                    items_train items_valid        items_test  accuracy   model  subject
0  [10, &quot;R1&quot;, &quot;R2&quot;, &quot;R3&quot;, &quot;R4&quot;]        null  [10, &quot;R5&quot;, &quot;R6&quot;]     0.675  EEGNet       10
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 34.488 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-02-deeplearning-03-example-2step-early-stopping-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/3952a1e62962a0433e63a68f6db0ca3f/03_example_2step_early_stopping.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">03_example_2step_early_stopping.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/0c012c5daabfa5b44decf59e17518dee/03_example_2step_early_stopping.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">03_example_2step_early_stopping.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/19b8e5d37589d8242efcffe5982b4585/03_example_2step_early_stopping.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">03_example_2step_early_stopping.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="02_example_plot_saliency_map.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Example 02: Plot Saliency Map</p>
      </div>
    </a>
    <a class="right-next"
       href="../../install.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">How to Install</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Example 03: 2-step Early Stopping</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#set-environment-variables-for-replicability">Set Environment Variables for Replicability</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">Import Packages</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#define-callback-functions">Define callback functions</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-experiment-using-early-stopping-with-validation-data">Run the Experiment using Early Stopping with Validation data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-experiment-using-early-stopping-with-callback-early-stopping">Run the Experiment using Early Stopping with callback_early_stopping</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#print-results">Print Results</a></li>
</ul>

  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/auto_examples/02_deeplearning/03_example_2step_early_stopping.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
       Copyright 2025, Simon Kojima.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.0.4.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>