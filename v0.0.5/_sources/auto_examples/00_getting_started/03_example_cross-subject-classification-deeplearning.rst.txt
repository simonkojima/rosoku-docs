
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/00_getting_started/03_example_cross-subject-classification-deeplearning.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_00_getting_started_03_example_cross-subject-classification-deeplearning.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_00_getting_started_03_example_cross-subject-classification-deeplearning.py:


Example: Cross-subject classification with deep learning
========================================================

.. GENERATED FROM PYTHON SOURCE LINES 5-10

.. code-block:: Python


    # Authors: Simon Kojima <simon.kojima@inria.fr>
    #
    # License: BSD (3-clause)








.. GENERATED FROM PYTHON SOURCE LINES 11-13

Import Packages
===============

.. GENERATED FROM PYTHON SOURCE LINES 13-23

.. code-block:: Python

    import functools
    import numpy as np
    from pathlib import Path
    import mne
    from moabb.datasets import Dreyer2023
    import torch
    import braindecode
    import rosoku









.. GENERATED FROM PYTHON SOURCE LINES 24-26

Define a callback function to load ndarray data
===============================================

.. GENERATED FROM PYTHON SOURCE LINES 26-82

.. code-block:: Python



    def callback_load_ndarray(
        items,
        split,
        tmin,
        tmax,
        l_freq,
        h_freq,
        order_filter,
        label_keys,
        dataset,
    ):
        X_list = []
        y_list = []

        for item in items:
            subject = item
            sessions = dataset.get_data(subjects=[subject])
            raws = sessions[subject]["0"]

            for name, raw in raws.items():
                raw.filter(
                    l_freq=l_freq,
                    h_freq=h_freq,
                    method="iir",
                    iir_params={
                        "ftype": "butter",
                        "order": order_filter,
                        "btype": "bandpass",
                    },
                )

                raw = raw.pick(picks="eeg")

                epochs = mne.Epochs(
                    raw=raw,
                    tmin=tmin,
                    tmax=tmax,
                    baseline=None,
                ).load_data()

                # Apply Domain Adoptation (Euclidean Alignment)
                X = rosoku.tl.euclidean_alignment(epochs.get_data())

                y = rosoku.utils.get_labels_from_epochs(epochs, label_keys=label_keys)

                X_list.append(X)
                y_list.append(y)

        X = np.concatenate(X_list, axis=0)
        y = np.concatenate(y_list, axis=0)

        return X, y









.. GENERATED FROM PYTHON SOURCE LINES 83-85

Define a callback function to load PyTorch model
================================================

.. GENERATED FROM PYTHON SOURCE LINES 85-106

.. code-block:: Python



    def callback_get_model(X, y):
        _, n_chans, n_times = X.shape
        F1 = 4
        D = 2
        F2 = F1 * D

        model = braindecode.models.EEGNet(
            n_chans=n_chans,
            n_outputs=2,
            n_times=n_times,
            F1=F1,
            D=D,
            F2=F2,
            drop_prob=0.25,
        )

        return model









.. GENERATED FROM PYTHON SOURCE LINES 107-109

Run the Experiment
==================

.. GENERATED FROM PYTHON SOURCE LINES 109-177

.. code-block:: Python


    lr = 1e-3
    weight_decay = 1e-2
    n_epochs = 500
    batch_size = 64
    patience = 75
    enable_normalization = True
    device = "cuda" if torch.cuda.is_available() else "cpu"

    seed = 42

    dataset = Dreyer2023()

    save_base = Path("~").expanduser() / "rosoku-log"
    (save_base / "checkpoint").mkdir(parents=True, exist_ok=True)
    (save_base / "history").mkdir(parents=True, exist_ok=True)
    (save_base / "saliency").mkdir(parents=True, exist_ok=True)
    (save_base / "samples").mkdir(parents=True, exist_ok=True)
    (save_base / "normalization").mkdir(parents=True, exist_ok=True)

    criterion = torch.nn.CrossEntropyLoss()
    scheduler = torch.optim.lr_scheduler.CosineAnnealingLR
    scheduler_params = {"T_max": n_epochs, "eta_min": 1e-6}
    optimizer = torch.optim.AdamW
    optimizer_params = {"lr": lr, "weight_decay": weight_decay}
    early_stopping = rosoku.utils.EarlyStopping(patience=patience)

    label_keys = {"left_hand": 0, "right_hand": 1}

    results = rosoku.deeplearning(
        items_train=[1, 2, 3],
        items_valid=[4],
        items_test=[21, 56],
        callback_load_ndarray=functools.partial(
            callback_load_ndarray,
            dataset=dataset,
            tmin=dataset.interval[0] + 0.5,
            tmax=dataset.interval[1],
            l_freq=8.0,
            h_freq=30.0,
            order_filter=4,
            label_keys=label_keys,
        ),
        batch_size=batch_size,
        n_epochs=n_epochs,
        criterion=criterion,
        optimizer=optimizer,
        optimizer_params=optimizer_params,
        callback_get_model=callback_get_model,
        scheduler=scheduler,
        scheduler_params=scheduler_params,
        device=device,
        callback_proc_epochs=None,
        early_stopping=early_stopping,
        enable_normalization=enable_normalization,
        scoring=["accuracy", "f1"],
        history_fname=(save_base / "history" / f"cross-subject-deeplearning.parquet"),
        checkpoint_fname=(save_base / "checkpoint" / f"cross-subject-deeplearning.pth"),
        samples_fname=(save_base / "samples" / f"cross-subject-deeplearning.parquet"),
        normalization_fname=(
            save_base / "normalization" / f"cross-subject-deeplearning.msgpack"
        ),
        saliency_map_fname=(save_base / "saliency" / f"cross-subject-deeplearning.msgpack"),
        label_keys=label_keys,
        seed=seed,
        additional_values={"example_key": "example_value"},
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    0it [00:00, ?it/s]    9it [00:00, 24369.75it/s]
    Reading 0 ... 230399  =      0.000 ...   449.998 secs...
    Reading 0 ... 230399  =      0.000 ...   449.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    0it [00:00, ?it/s]    9it [00:00, 22349.75it/s]
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    0it [00:00, ?it/s]    9it [00:00, 22822.69it/s]
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    0it [00:00, ?it/s]    9it [00:00, 18192.16it/s]
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    0it [00:00, ?it/s]    9it [00:00, 17533.09it/s]
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    0it [00:00, ?it/s]    9it [00:00, 20262.34it/s]
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Reading 0 ... 230911  =      0.000 ...   450.998 secs...
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 8 - 30 Hz

    IIR filter parameters
    ---------------------
    Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 8.00, 30.00 Hz: -6.02, -6.02 dB

    Used Annotations descriptions: [np.str_('left_hand'), np.str_('right_hand')]
    Ignoring annotation durations and creating fixed-duration epochs around annotation onsets.
    Not setting metadata
    40 matching events found
    No baseline correction applied
    0 projection items activated
    Using data from preloaded Raw for 40 events and 2305 original time points ...
    0 bad epochs dropped
    epoch 000, train_loss: 0.7000, train_acc: 0.50, valid_loss: 0.6932, valid_acc: 0.48, lr: 9.9999e-04, et: 0.8746, checkpoint saved
    epoch 001, train_loss: 0.6818, train_acc: 0.58, valid_loss: 0.6932, valid_acc: 0.49, lr: 9.9996e-04, et: 0.4510
    epoch 002, train_loss: 0.6705, train_acc: 0.59, valid_loss: 0.6935, valid_acc: 0.50, lr: 9.9991e-04, et: 0.4862
    epoch 003, train_loss: 0.6611, train_acc: 0.64, valid_loss: 0.6938, valid_acc: 0.48, lr: 9.9984e-04, et: 0.4091
    epoch 004, train_loss: 0.6484, train_acc: 0.65, valid_loss: 0.6940, valid_acc: 0.50, lr: 9.9975e-04, et: 0.4109
    epoch 005, train_loss: 0.6384, train_acc: 0.64, valid_loss: 0.6945, valid_acc: 0.50, lr: 9.9965e-04, et: 0.4021
    epoch 006, train_loss: 0.6340, train_acc: 0.66, valid_loss: 0.6955, valid_acc: 0.50, lr: 9.9952e-04, et: 0.4084
    epoch 007, train_loss: 0.6228, train_acc: 0.67, valid_loss: 0.6960, valid_acc: 0.53, lr: 9.9937e-04, et: 0.4053
    epoch 008, train_loss: 0.6161, train_acc: 0.69, valid_loss: 0.6968, valid_acc: 0.51, lr: 9.9920e-04, et: 0.4042
    epoch 009, train_loss: 0.5949, train_acc: 0.72, valid_loss: 0.6982, valid_acc: 0.52, lr: 9.9901e-04, et: 0.4101
    epoch 010, train_loss: 0.5953, train_acc: 0.71, valid_loss: 0.7004, valid_acc: 0.54, lr: 9.9881e-04, et: 0.4032
    epoch 011, train_loss: 0.5902, train_acc: 0.72, valid_loss: 0.7020, valid_acc: 0.55, lr: 9.9858e-04, et: 0.4065
    epoch 012, train_loss: 0.5653, train_acc: 0.73, valid_loss: 0.7067, valid_acc: 0.54, lr: 9.9833e-04, et: 0.4071
    epoch 013, train_loss: 0.5574, train_acc: 0.74, valid_loss: 0.7077, valid_acc: 0.55, lr: 9.9807e-04, et: 0.4050
    epoch 014, train_loss: 0.5602, train_acc: 0.73, valid_loss: 0.7146, valid_acc: 0.53, lr: 9.9778e-04, et: 0.4084
    epoch 015, train_loss: 0.5350, train_acc: 0.76, valid_loss: 0.7166, valid_acc: 0.55, lr: 9.9748e-04, et: 0.4049
    epoch 016, train_loss: 0.5325, train_acc: 0.76, valid_loss: 0.7199, valid_acc: 0.55, lr: 9.9715e-04, et: 0.4047
    epoch 017, train_loss: 0.5261, train_acc: 0.77, valid_loss: 0.7341, valid_acc: 0.53, lr: 9.9681e-04, et: 0.4077
    epoch 018, train_loss: 0.5182, train_acc: 0.76, valid_loss: 0.7293, valid_acc: 0.54, lr: 9.9644e-04, et: 0.4079
    epoch 019, train_loss: 0.5160, train_acc: 0.78, valid_loss: 0.7324, valid_acc: 0.54, lr: 9.9606e-04, et: 0.4069
    epoch 020, train_loss: 0.4970, train_acc: 0.78, valid_loss: 0.7392, valid_acc: 0.54, lr: 9.9566e-04, et: 0.4048
    epoch 021, train_loss: 0.4775, train_acc: 0.79, valid_loss: 0.7414, valid_acc: 0.55, lr: 9.9524e-04, et: 0.4062
    epoch 022, train_loss: 0.4777, train_acc: 0.79, valid_loss: 0.7506, valid_acc: 0.52, lr: 9.9479e-04, et: 0.4053
    epoch 023, train_loss: 0.4760, train_acc: 0.77, valid_loss: 0.7466, valid_acc: 0.56, lr: 9.9433e-04, et: 0.4067
    epoch 024, train_loss: 0.4633, train_acc: 0.79, valid_loss: 0.7562, valid_acc: 0.55, lr: 9.9385e-04, et: 0.4066
    epoch 025, train_loss: 0.4593, train_acc: 0.80, valid_loss: 0.7598, valid_acc: 0.55, lr: 9.9335e-04, et: 0.4062
    epoch 026, train_loss: 0.4606, train_acc: 0.79, valid_loss: 0.7562, valid_acc: 0.57, lr: 9.9283e-04, et: 0.4081
    epoch 027, train_loss: 0.4338, train_acc: 0.82, valid_loss: 0.7573, valid_acc: 0.57, lr: 9.9229e-04, et: 0.4058
    epoch 028, train_loss: 0.4285, train_acc: 0.83, valid_loss: 0.7687, valid_acc: 0.56, lr: 9.9173e-04, et: 0.4063
    epoch 029, train_loss: 0.4195, train_acc: 0.83, valid_loss: 0.7708, valid_acc: 0.57, lr: 9.9115e-04, et: 0.4066
    epoch 030, train_loss: 0.4133, train_acc: 0.82, valid_loss: 0.7857, valid_acc: 0.56, lr: 9.9055e-04, et: 0.4069
    epoch 031, train_loss: 0.4011, train_acc: 0.84, valid_loss: 0.8016, valid_acc: 0.55, lr: 9.8994e-04, et: 0.4082
    epoch 032, train_loss: 0.3839, train_acc: 0.83, valid_loss: 0.8125, valid_acc: 0.56, lr: 9.8930e-04, et: 0.4087
    epoch 033, train_loss: 0.3769, train_acc: 0.85, valid_loss: 0.8106, valid_acc: 0.56, lr: 9.8865e-04, et: 0.4145
    epoch 034, train_loss: 0.3744, train_acc: 0.85, valid_loss: 0.8197, valid_acc: 0.57, lr: 9.8797e-04, et: 0.4083
    epoch 035, train_loss: 0.3767, train_acc: 0.85, valid_loss: 0.8348, valid_acc: 0.53, lr: 9.8728e-04, et: 0.4073
    epoch 036, train_loss: 0.3435, train_acc: 0.86, valid_loss: 0.8498, valid_acc: 0.53, lr: 9.8656e-04, et: 0.4076
    epoch 037, train_loss: 0.3471, train_acc: 0.86, valid_loss: 0.8546, valid_acc: 0.55, lr: 9.8583e-04, et: 0.4080
    epoch 038, train_loss: 0.3219, train_acc: 0.87, valid_loss: 0.8659, valid_acc: 0.56, lr: 9.8508e-04, et: 0.4084
    epoch 039, train_loss: 0.3142, train_acc: 0.87, valid_loss: 0.8753, valid_acc: 0.58, lr: 9.8431e-04, et: 0.4099
    epoch 040, train_loss: 0.3172, train_acc: 0.87, valid_loss: 0.8967, valid_acc: 0.59, lr: 9.8352e-04, et: 0.4077
    epoch 041, train_loss: 0.3070, train_acc: 0.88, valid_loss: 0.8842, valid_acc: 0.56, lr: 9.8271e-04, et: 0.4093
    epoch 042, train_loss: 0.2868, train_acc: 0.89, valid_loss: 0.9096, valid_acc: 0.59, lr: 9.8188e-04, et: 0.4066
    epoch 043, train_loss: 0.2952, train_acc: 0.89, valid_loss: 0.9082, valid_acc: 0.59, lr: 9.8103e-04, et: 0.4084
    epoch 044, train_loss: 0.2827, train_acc: 0.90, valid_loss: 0.9233, valid_acc: 0.59, lr: 9.8017e-04, et: 0.4088
    epoch 045, train_loss: 0.2569, train_acc: 0.90, valid_loss: 0.9628, valid_acc: 0.56, lr: 9.7928e-04, et: 0.4092
    epoch 046, train_loss: 0.2738, train_acc: 0.88, valid_loss: 0.9399, valid_acc: 0.60, lr: 9.7838e-04, et: 0.4104
    epoch 047, train_loss: 0.2659, train_acc: 0.90, valid_loss: 0.9713, valid_acc: 0.56, lr: 9.7745e-04, et: 0.4075
    epoch 048, train_loss: 0.2556, train_acc: 0.90, valid_loss: 0.9674, valid_acc: 0.58, lr: 9.7651e-04, et: 0.4082
    epoch 049, train_loss: 0.2858, train_acc: 0.89, valid_loss: 0.9525, valid_acc: 0.58, lr: 9.7555e-04, et: 0.4116
    epoch 050, train_loss: 0.2687, train_acc: 0.88, valid_loss: 0.9389, valid_acc: 0.59, lr: 9.7457e-04, et: 0.4073
    epoch 051, train_loss: 0.2513, train_acc: 0.90, valid_loss: 0.9425, valid_acc: 0.60, lr: 9.7358e-04, et: 0.4114
    epoch 052, train_loss: 0.2702, train_acc: 0.88, valid_loss: 0.9211, valid_acc: 0.62, lr: 9.7256e-04, et: 0.4081
    epoch 053, train_loss: 0.2598, train_acc: 0.89, valid_loss: 0.9079, valid_acc: 0.61, lr: 9.7152e-04, et: 0.4096
    epoch 054, train_loss: 0.2371, train_acc: 0.91, valid_loss: 0.8962, valid_acc: 0.58, lr: 9.7047e-04, et: 0.4092
    epoch 055, train_loss: 0.2383, train_acc: 0.92, valid_loss: 0.9280, valid_acc: 0.60, lr: 9.6940e-04, et: 0.4095
    epoch 056, train_loss: 0.2410, train_acc: 0.90, valid_loss: 0.9493, valid_acc: 0.60, lr: 9.6831e-04, et: 0.4105
    epoch 057, train_loss: 0.2332, train_acc: 0.91, valid_loss: 0.9397, valid_acc: 0.59, lr: 9.6720e-04, et: 0.4076
    epoch 058, train_loss: 0.2107, train_acc: 0.93, valid_loss: 0.9266, valid_acc: 0.60, lr: 9.6607e-04, et: 0.4103
    epoch 059, train_loss: 0.2398, train_acc: 0.92, valid_loss: 0.9537, valid_acc: 0.60, lr: 9.6492e-04, et: 0.4086
    epoch 060, train_loss: 0.2312, train_acc: 0.90, valid_loss: 0.9433, valid_acc: 0.58, lr: 9.6376e-04, et: 0.4087
    epoch 061, train_loss: 0.2272, train_acc: 0.92, valid_loss: 0.9179, valid_acc: 0.59, lr: 9.6258e-04, et: 0.4099
    epoch 062, train_loss: 0.2146, train_acc: 0.92, valid_loss: 0.9268, valid_acc: 0.59, lr: 9.6138e-04, et: 0.4068
    epoch 063, train_loss: 0.1924, train_acc: 0.93, valid_loss: 0.9472, valid_acc: 0.59, lr: 9.6016e-04, et: 0.4110
    epoch 064, train_loss: 0.2060, train_acc: 0.92, valid_loss: 0.9053, valid_acc: 0.58, lr: 9.5892e-04, et: 0.4077
    epoch 065, train_loss: 0.2030, train_acc: 0.92, valid_loss: 0.8920, valid_acc: 0.59, lr: 9.5766e-04, et: 0.4147
    epoch 066, train_loss: 0.2151, train_acc: 0.92, valid_loss: 0.9019, valid_acc: 0.60, lr: 9.5639e-04, et: 0.4100
    epoch 067, train_loss: 0.1837, train_acc: 0.93, valid_loss: 0.8962, valid_acc: 0.60, lr: 9.5510e-04, et: 0.4105
    epoch 068, train_loss: 0.1867, train_acc: 0.93, valid_loss: 0.9120, valid_acc: 0.60, lr: 9.5379e-04, et: 0.4103
    epoch 069, train_loss: 0.2053, train_acc: 0.91, valid_loss: 0.8986, valid_acc: 0.61, lr: 9.5246e-04, et: 0.4096
    epoch 070, train_loss: 0.1989, train_acc: 0.92, valid_loss: 0.8946, valid_acc: 0.60, lr: 9.5112e-04, et: 0.4108
    epoch 071, train_loss: 0.1984, train_acc: 0.92, valid_loss: 0.9100, valid_acc: 0.61, lr: 9.4975e-04, et: 0.4111
    epoch 072, train_loss: 0.1920, train_acc: 0.92, valid_loss: 0.9142, valid_acc: 0.61, lr: 9.4837e-04, et: 0.4104
    epoch 073, train_loss: 0.1995, train_acc: 0.91, valid_loss: 0.9243, valid_acc: 0.60, lr: 9.4697e-04, et: 0.4115
    epoch 074, train_loss: 0.1922, train_acc: 0.93, valid_loss: 0.9090, valid_acc: 0.57, lr: 9.4556e-04, et: 0.4134
    epoch 075, train_loss: 0.2247, train_acc: 0.91, valid_loss: 0.9033, valid_acc: 0.58, lr: 9.4412e-04, et: 0.4092
    Early stopping was triggered: epoch #76
    Elapsed Time: 31.63s




.. GENERATED FROM PYTHON SOURCE LINES 178-180

Print Results
=============

.. GENERATED FROM PYTHON SOURCE LINES 180-182

.. code-block:: Python


    print(results.to_string())




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      items_train items_valid items_test  accuracy        f1   model    example_key
    0   [1, 2, 3]         [4]         21  0.516667  0.292683  EEGNet  example_value
    1   [1, 2, 3]         [4]         56  0.533333  0.363636  EEGNet  example_value





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 43.397 seconds)


.. _sphx_glr_download_auto_examples_00_getting_started_03_example_cross-subject-classification-deeplearning.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: 03_example_cross-subject-classification-deeplearning.ipynb <03_example_cross-subject-classification-deeplearning.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: 03_example_cross-subject-classification-deeplearning.py <03_example_cross-subject-classification-deeplearning.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: 03_example_cross-subject-classification-deeplearning.zip <03_example_cross-subject-classification-deeplearning.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
